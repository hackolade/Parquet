var Jr=Object.defineProperty;var d=(e,i)=>Jr(e,"name",{value:i,configurable:!0});var T=(e,i)=>()=>(i||e((i={exports:{}}).exports,i),i.exports);var ve=T((Co,Ri)=>{var He=4294967296,Ai=[];for(Z=0;Z<256;Z++)Ai[Z]=(Z>15?"":"0")+Z.toString(16);var Z,ge=Ri.exports=function(e,i){e instanceof Buffer?(this.buffer=e,this.offset=i||0):Object.prototype.toString.call(e)=="[object Uint8Array]"?(this.buffer=new Buffer(e),this.offset=i||0):(this.buffer=this.buffer||new Buffer(8),this.offset=0,this.setValue.apply(this,arguments))};ge.MAX_INT=Math.pow(2,53);ge.MIN_INT=-Math.pow(2,53);ge.prototype={_2scomp:function(){for(var e=this.buffer,i=this.offset,r=1,t=i+7;t>=i;t--){var n=(e[t]^255)+r;e[t]=n&255,r=n>>8}},setValue:function(e,i){var r=!1;if(arguments.length==1)if(typeof e=="number"){if(r=e<0,e=Math.abs(e),i=e%He,e=e/He,e>He)throw new RangeError(e+" is outside Int64 range");e=e|0}else if(typeof e=="string")e=(e+"").replace(/^0x/,""),i=e.substr(-8),e=e.length>8?e.substr(0,e.length-8):"",e=parseInt(e,16),i=parseInt(i,16);else throw new Error(e+" must be a Number or String");for(var t=this.buffer,n=this.offset,s=7;s>=0;s--)t[n+s]=i&255,i=s==4?e:i>>>8;r&&this._2scomp()},toNumber:function(e){for(var i=this.buffer,r=this.offset,t=i[r]&128,n=0,s=1,o=7,l=1;o>=0;o--,l*=256){var c=i[r+o];t&&(c=(c^255)+s,s=c>>8,c=c&255),n+=c*l}return!e&&n>=ge.MAX_INT?t?-1/0:1/0:t?-n:n},valueOf:function(){return this.toNumber(!1)},toString:function(e){return this.valueOf().toString(e||10)},toOctetString:function(e){for(var i=new Array(8),r=this.buffer,t=this.offset,n=0;n<8;n++)i[n]=Ai[r[t+n]];return i.join(e||"")},toBuffer:function(e){if(e&&this.offset===0)return this.buffer;var i=new Buffer(8);return this.buffer.copy(i,0,this.offset,this.offset+8),i},copy:function(e,i){this.buffer.copy(e,i||0,this.offset,this.offset+8)},inspect:function(){return"[Int64 value:"+this+" octets:"+this.toOctetString(" ")+"]"}}});var Ke=T((D,Je)=>{var Se=require("util"),ie=D.Type={STOP:0,VOID:1,BOOL:2,BYTE:3,I08:3,DOUBLE:4,I16:6,I32:8,I64:10,STRING:11,UTF7:11,STRUCT:12,MAP:13,SET:14,LIST:15,UTF8:16,UTF16:17};D.MessageType={CALL:1,REPLY:2,EXCEPTION:3,ONEWAY:4};D.TException=Be;function Be(e){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e}d(Be,"TException");Se.inherits(Be,Error);var Kr=D.TApplicationExceptionType={UNKNOWN:0,UNKNOWN_METHOD:1,INVALID_MESSAGE_TYPE:2,WRONG_METHOD_NAME:3,BAD_SEQUENCE_ID:4,MISSING_RESULT:5,INTERNAL_ERROR:6,PROTOCOL_ERROR:7,INVALID_TRANSFORM:8,INVALID_PROTOCOL:9,UNSUPPORTED_CLIENT_TYPE:10};D.TApplicationException=Fe;function Fe(e,i){Be.call(this),Error.captureStackTrace(this,this.constructor),this.type=e||Kr.UNKNOWN,this.name=this.constructor.name,this.message=i}d(Fe,"TApplicationException");Se.inherits(Fe,Be);Fe.prototype.read=function(e){for(var i,r=e.readStructBegin("TApplicationException");r=e.readFieldBegin(),r.ftype!=ie.STOP;){switch(r.fid){case 1:r.ftype==ie.STRING?(r=e.readString(),this.message=r):r=e.skip(r.ftype);break;case 2:r.ftype==ie.I32?(r=e.readI32(),this.type=r):r=e.skip(r.ftype);break;default:r=e.skip(r.ftype);break}e.readFieldEnd()}e.readStructEnd()};Fe.prototype.write=function(e){e.writeStructBegin("TApplicationException"),this.message&&(e.writeFieldBegin("message",ie.STRING,1),e.writeString(this.message),e.writeFieldEnd()),this.code&&(e.writeFieldBegin("type",ie.I32,2),e.writeI32(this.code),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};var Mo=D.TProtocolExceptionType={UNKNOWN:0,INVALID_DATA:1,NEGATIVE_SIZE:2,SIZE_LIMIT:3,BAD_VERSION:4,NOT_IMPLEMENTED:5,DEPTH_LIMIT:6};D.TProtocolException=Ci;function Ci(e,i){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.type=e,this.message=i}d(Ci,"TProtocolException");Se.inherits(Ci,Error);D.objectLength=function(e){return Object.keys(e).length};D.inherits=function(e,i){Se.inherits(e,i)};var Ie,Ee;Ie=d(function(e,i){if(!e)return e;var r;i.shift===void 0?r=i:r=i[0];var t=r,n=e.length,s=[],o,l;for(o=0;o<n;o++)l=e[o],r===null?s.push(l):r===Ee||r===Ie?s.push(r(l,i.slice(1))):s.push(new t(l));return s},"copyList");Ee=d(function(e,i){if(!e)return e;var r;i.shift===void 0?r=i:r=i[0];var t=r,n={},s;for(var o in e)e.hasOwnProperty(o)&&(s=e[o],r===null?n[o]=s:r===Ee||r===Ie?n[o]=r(s,i.slice(1)):n[o]=new t(s));return n},"copyMap");Je.exports.copyMap=Ee;Je.exports.copyList=Ie});var Xe=T(Y=>{var Ze=Math.pow(2,8),Zr=Math.pow(2,16),Mi=Math.pow(2,24),Ui=Math.pow(2,32),Qr=Math.pow(2,40),Xr=Math.pow(2,48),Qe=Math.pow(2,52),$r=Math.pow(2,1022);Y.readByte=function(e){return e>127?e-256:e};Y.readI16=function(e,i){i=i||0;var r=e[i+1];return r+=e[i]<<8,e[i]&128&&(r-=Zr),r};Y.readI32=function(e,i){i=i||0;var r=e[i+3];return r+=e[i+2]<<8,r+=e[i+1]<<16,r+=e[i]*Mi,e[i]&128&&(r-=Ui),r};Y.writeI16=function(e,i){return e[1]=i&255,i>>=8,e[0]=i&255,e};Y.writeI32=function(e,i){return e[3]=i&255,i>>=8,e[2]=i&255,i>>=8,e[1]=i&255,i>>=8,e[0]=i&255,e};Y.readDouble=function(e,i){i=i||0;var r=e[i]&128,t=(e[i+1]&240)>>4;t+=(e[i]&127)<<4;var n=e[i+7];switch(n+=e[i+6]<<8,n+=e[i+5]<<16,n+=e[i+4]*Mi,n+=e[i+3]*Ui,n+=e[i+2]*Qr,n+=(e[i+1]&15)*Xr,t){case 0:t=-1022;break;case 2047:return n?NaN:r?-1/0:1/0;default:n+=Qe,t-=1023}return r&&(n*=-1),n*Math.pow(2,t-52)};Y.writeDouble=function(e,i){var r,t,n;return e[0]=i<0?128:0,i=Math.abs(i),i!==i?(r=0x8000000000000,t=2047):i===1/0?(r=0,t=2047):(t=Math.floor(Math.log(i)/Math.LN2),n=Math.pow(2,-t),i*n<1&&(t--,n*=2),t+1023>=2047?(r=0,t=2047):t+1023>=1?(r=(i*n-1)*Qe,t+=1023):(r=i*$r*Qe,t=0)),e[1]=t<<4&240,e[0]|=t>>4&127,e[7]=r&255,r=Math.floor(r/Ze),e[6]=r&255,r=Math.floor(r/Ze),e[5]=r&255,r=Math.floor(r/Ze),e[4]=r&255,r>>=8,e[3]=r&255,r>>=8,e[2]=r&255,r>>=8,e[1]|=r&15,e}});var $e=T((zo,zi)=>{var en=require("util");zi.exports=Di;function Di(e){Error.call(this),Error.captureStackTrace(this,this.constructor),this.name=this.constructor.name,this.message=e}d(Di,"InputBufferUnderrunError");en.inherits(Di,Error)});var Vi=T((Vo,qi)=>{var Q=Xe(),tn=$e();qi.exports=x;function x(e,i){this.inBuf=e||new Buffer(0),this.outBuffers=[],this.outCount=0,this.readPos=0,this.onFlush=i}d(x,"TFramedTransport");x.receiver=function(e,i){var r=null;return function(t){for(r&&(t=Buffer.concat([r,t]),r=null);t.length;){if(t.length<4){r=t;return}var n=Q.readI32(t,0);if(t.length<4+n){r=t;return}var s=t.slice(4,4+n);r=t.slice(4+n),e(new x(s),i),t=r,r=null}}};x.prototype.commitPosition=function(){},x.prototype.rollbackPosition=function(){},x.prototype.isOpen=function(){return!0};x.prototype.open=function(){};x.prototype.close=function(){};x.prototype.setCurrSeqId=function(e){this._seqid=e};x.prototype.ensureAvailable=function(e){if(this.readPos+e>this.inBuf.length)throw new tn};x.prototype.read=function(e){this.ensureAvailable(e);var i=this.readPos+e;if(this.inBuf.length<i)throw new Error("read("+e+") failed - not enough data");var r=this.inBuf.slice(this.readPos,i);return this.readPos=i,r};x.prototype.readByte=function(){return this.ensureAvailable(1),Q.readByte(this.inBuf[this.readPos++])};x.prototype.readI16=function(){this.ensureAvailable(2);var e=Q.readI16(this.inBuf,this.readPos);return this.readPos+=2,e};x.prototype.readI32=function(){this.ensureAvailable(4);var e=Q.readI32(this.inBuf,this.readPos);return this.readPos+=4,e};x.prototype.readDouble=function(){this.ensureAvailable(8);var e=Q.readDouble(this.inBuf,this.readPos);return this.readPos+=8,e};x.prototype.readString=function(e){this.ensureAvailable(e);var i=this.inBuf.toString("utf8",this.readPos,this.readPos+e);return this.readPos+=e,i};x.prototype.borrow=function(){return{buf:this.inBuf,readIndex:this.readPos,writeIndex:this.inBuf.length}};x.prototype.consume=function(e){this.readPos+=e};x.prototype.write=function(e,i){typeof e=="string"&&(e=new Buffer(e,i||"utf8")),this.outBuffers.push(e),this.outCount+=e.length};x.prototype.flush=function(){var e=this._seqid;this._seqid=null;var i=new Buffer(this.outCount),r=0;if(this.outBuffers.forEach(function(n){n.copy(i,r,0),r+=n.length}),this.onFlush){var t=new Buffer(i.length+4);Q.writeI32(t,i.length),i.copy(t,4,0,i.length),this.onFlush&&this.onFlush(t,e)}this.outBuffers=[],this.outCount=0}});var Yi=T((Yo,Gi)=>{var xe=Xe(),rn=$e();Gi.exports=L;function L(e,i){this.defaultReadBufferSize=1024,this.writeBufferSize=512,this.inBuf=new Buffer(this.defaultReadBufferSize),this.readCursor=0,this.writeCursor=0,this.outBuffers=[],this.outCount=0,this.onFlush=i}d(L,"TBufferedTransport");L.receiver=function(e,i){var r=new L;return function(t){if(r.writeCursor+t.length>r.inBuf.length){var n=new Buffer(r.writeCursor+t.length);r.inBuf.copy(n,0,0,r.writeCursor),r.inBuf=n}t.copy(r.inBuf,r.writeCursor,0),r.writeCursor+=t.length,e(r,i)}};L.prototype.commitPosition=function(){var e=this.writeCursor-this.readCursor,i=e*2>this.defaultReadBufferSize?e*2:this.defaultReadBufferSize,r=new Buffer(i);e>0&&this.inBuf.copy(r,0,this.readCursor,this.writeCursor),this.readCursor=0,this.writeCursor=e,this.inBuf=r};L.prototype.rollbackPosition=function(){this.readCursor=0};L.prototype.isOpen=function(){return!0};L.prototype.open=function(){};L.prototype.close=function(){};L.prototype.setCurrSeqId=function(e){this._seqid=e};L.prototype.ensureAvailable=function(e){if(this.readCursor+e>this.writeCursor)throw new rn};L.prototype.read=function(e){this.ensureAvailable(e);var i=new Buffer(e);return this.inBuf.copy(i,0,this.readCursor,this.readCursor+e),this.readCursor+=e,i};L.prototype.readByte=function(){return this.ensureAvailable(1),xe.readByte(this.inBuf[this.readCursor++])};L.prototype.readI16=function(){this.ensureAvailable(2);var e=xe.readI16(this.inBuf,this.readCursor);return this.readCursor+=2,e};L.prototype.readI32=function(){this.ensureAvailable(4);var e=xe.readI32(this.inBuf,this.readCursor);return this.readCursor+=4,e};L.prototype.readDouble=function(){this.ensureAvailable(8);var e=xe.readDouble(this.inBuf,this.readCursor);return this.readCursor+=8,e};L.prototype.readString=function(e){this.ensureAvailable(e);var i=this.inBuf.toString("utf8",this.readCursor,this.readCursor+e);return this.readCursor+=e,i};L.prototype.borrow=function(){var e={buf:this.inBuf,readIndex:this.readCursor,writeIndex:this.writeCursor};return e};L.prototype.consume=function(e){this.readCursor+=e};L.prototype.write=function(e){typeof e=="string"&&(e=new Buffer(e,"utf8")),this.outBuffers.push(e),this.outCount+=e.length};L.prototype.flush=function(){var e=this._seqid;if(this._seqid=null,!(this.outCount<1)){var i=new Buffer(this.outCount),r=0;this.outBuffers.forEach(function(t){t.copy(i,r,0),r+=t.length}),this.onFlush&&this.onFlush(i,e),this.outBuffers=[],this.outCount=0}}});var ji=T((jo,Wi)=>{Wi.exports={info:d(function(){},"logInfo"),warning:d(function(){},"logWarning"),error:d(function(){},"logError"),debug:d(function(){},"logDebug"),trace:d(function(){},"logTrace")}});var Ji=T((Jo,Hi)=>{var nn=ji(),q=ve(),F=Ke(),I=F.Type;Hi.exports=f;var ei=Math.pow(2,8),sn=Math.pow(2,24),an=Math.pow(2,32),on=Math.pow(2,40),dn=Math.pow(2,48),ii=Math.pow(2,52),ln=Math.pow(2,1022);function f(e){this.trans=e,this.lastField_=[],this.lastFieldId_=0,this.string_limit_=0,this.string_buf_=null,this.string_buf_size_=0,this.container_limit_=0,this.booleanField_={name:null,hasBoolValue:!1},this.boolValue_={hasBoolValue:!1,boolValue:!1}}d(f,"TCompactProtocol");f.PROTOCOL_ID=-126;f.VERSION_N=1;f.VERSION_MASK=31;f.TYPE_MASK=-32;f.TYPE_BITS=7;f.TYPE_SHIFT_AMOUNT=5;f.Types={CT_STOP:0,CT_BOOLEAN_TRUE:1,CT_BOOLEAN_FALSE:2,CT_BYTE:3,CT_I16:4,CT_I32:5,CT_I64:6,CT_DOUBLE:7,CT_BINARY:8,CT_LIST:9,CT_SET:10,CT_MAP:11,CT_STRUCT:12};f.TTypeToCType=[f.Types.CT_STOP,0,f.Types.CT_BOOLEAN_TRUE,f.Types.CT_BYTE,f.Types.CT_DOUBLE,0,f.Types.CT_I16,0,f.Types.CT_I32,0,f.Types.CT_I64,f.Types.CT_BINARY,f.Types.CT_STRUCT,f.Types.CT_MAP,f.Types.CT_SET,f.Types.CT_LIST];f.prototype.getTransport=function(){return this.trans};f.prototype.getCompactType=function(e){return f.TTypeToCType[e]};f.prototype.getTType=function(e){switch(e){case I.STOP:return I.STOP;case f.Types.CT_BOOLEAN_FALSE:case f.Types.CT_BOOLEAN_TRUE:return I.BOOL;case f.Types.CT_BYTE:return I.BYTE;case f.Types.CT_I16:return I.I16;case f.Types.CT_I32:return I.I32;case f.Types.CT_I64:return I.I64;case f.Types.CT_DOUBLE:return I.DOUBLE;case f.Types.CT_BINARY:return I.STRING;case f.Types.CT_LIST:return I.LIST;case f.Types.CT_SET:return I.SET;case f.Types.CT_MAP:return I.MAP;case f.Types.CT_STRUCT:return I.STRUCT;default:throw new F.TProtocolException(F.TProtocolExceptionType.INVALID_DATA,"Unknown type: "+e)}return I.STOP};f.prototype.flush=function(){return this.trans.flush()};f.prototype.writeMessageBegin=function(e,i,r){this.writeByte(f.PROTOCOL_ID),this.writeByte(f.VERSION_N&f.VERSION_MASK|i<<f.TYPE_SHIFT_AMOUNT&f.TYPE_MASK),this.writeVarint32(r),this.writeString(e),this._seqid?nn.warning("SeqId already set",{name:e}):(this._seqid=r,this.trans.setCurrSeqId(r))};f.prototype.writeMessageEnd=function(){};f.prototype.writeStructBegin=function(e){this.lastField_.push(this.lastFieldId_),this.lastFieldId_=0};f.prototype.writeStructEnd=function(){this.lastFieldId_=this.lastField_.pop()};f.prototype.writeFieldBegin=function(e,i,r){if(i!=I.BOOL)return this.writeFieldBeginInternal(e,i,r,-1);this.booleanField_.name=e,this.booleanField_.fieldType=i,this.booleanField_.fieldId=r};f.prototype.writeFieldEnd=function(){};f.prototype.writeFieldStop=function(){this.writeByte(f.Types.CT_STOP)};f.prototype.writeMapBegin=function(e,i,r){r===0?this.writeByte(0):(this.writeVarint32(r),this.writeByte(this.getCompactType(e)<<4|this.getCompactType(i)))};f.prototype.writeMapEnd=function(){};f.prototype.writeListBegin=function(e,i){this.writeCollectionBegin(e,i)};f.prototype.writeListEnd=function(){};f.prototype.writeSetBegin=function(e,i){this.writeCollectionBegin(e,i)};f.prototype.writeSetEnd=function(){};f.prototype.writeBool=function(e){this.booleanField_.name!==null?(this.writeFieldBeginInternal(this.booleanField_.name,this.booleanField_.fieldType,this.booleanField_.fieldId,e?f.Types.CT_BOOLEAN_TRUE:f.Types.CT_BOOLEAN_FALSE),this.booleanField_.name=null):this.writeByte(e?f.Types.CT_BOOLEAN_TRUE:f.Types.CT_BOOLEAN_FALSE)};f.prototype.writeByte=function(e){this.trans.write(new Buffer([e]))};f.prototype.writeI16=function(e){this.writeVarint32(this.i32ToZigzag(e))};f.prototype.writeI32=function(e){this.writeVarint32(this.i32ToZigzag(e))};f.prototype.writeI64=function(e){this.writeVarint64(this.i64ToZigzag(e))};f.prototype.writeDouble=function(e){var i=new Buffer(8),r,t,n;i[7]=e<0?128:0,e=Math.abs(e),e!==e?(r=0x8000000000000,t=2047):e===1/0?(r=0,t=2047):(t=Math.floor(Math.log(e)/Math.LN2),n=Math.pow(2,-t),e*n<1&&(t--,n*=2),t+1023>=2047?(r=0,t=2047):t+1023>=1?(r=(e*n-1)*ii,t+=1023):(r=e*ln*ii,t=0)),i[6]=t<<4&240,i[7]|=t>>4&127,i[0]=r&255,r=Math.floor(r/ei),i[1]=r&255,r=Math.floor(r/ei),i[2]=r&255,r=Math.floor(r/ei),i[3]=r&255,r>>=8,i[4]=r&255,r>>=8,i[5]=r&255,r>>=8,i[6]|=r&15,this.trans.write(i)};f.prototype.writeStringOrBinary=function(e,i,r){if(typeof r=="string")this.writeVarint32(Buffer.byteLength(r,i)),this.trans.write(new Buffer(r,i));else if(r instanceof Buffer||Object.prototype.toString.call(r)=="[object Uint8Array]")this.writeVarint32(r.length),this.trans.write(r);else throw new Error(e+" called without a string/Buffer argument: "+r)};f.prototype.writeString=function(e){this.writeStringOrBinary("writeString","utf8",e)};f.prototype.writeBinary=function(e){this.writeStringOrBinary("writeBinary","binary",e)};f.prototype.writeFieldBeginInternal=function(e,i,r,t){var n=t==-1?this.getCompactType(i):t;r>this.lastFieldId_&&r-this.lastFieldId_<=15?this.writeByte(r-this.lastFieldId_<<4|n):(this.writeByte(n),this.writeI16(r)),this.lastFieldId_=r};f.prototype.writeCollectionBegin=function(e,i){i<=14?this.writeByte(i<<4|this.getCompactType(e)):(this.writeByte(240|this.getCompactType(e)),this.writeVarint32(i))};f.prototype.writeVarint32=function(e){for(var i=new Buffer(5),r=0;;)if(e&-128)i[r++]=e&127|128,e=e>>>7;else{i[r++]=e;break}var t=new Buffer(r);i.copy(t,0,0,r),this.trans.write(t)};f.prototype.writeVarint64=function(e){if(typeof e=="number"&&(e=new q(e)),!(e instanceof q))throw new F.TProtocolException(F.TProtocolExceptionType.INVALID_DATA,"Expected Int64 or Number, found: "+e);for(var i=new Buffer(10),r=0,t=e.buffer.readUInt32BE(0,!0),n=e.buffer.readUInt32BE(4,!0),s=0;;)if(!(n&-128)&&t===0){i[r++]=n;break}else i[r++]=n&127|128,s=t<<25,n=n>>>7,t=t>>>7,n=n|s;var o=new Buffer(r);i.copy(o,0,0,r),this.trans.write(o)};f.prototype.i64ToZigzag=function(e){if(typeof e=="string"?e=new q(parseInt(e,10)):typeof e=="number"&&(e=new q(e)),!(e instanceof q))throw new F.TProtocolException(F.TProtocolExceptionType.INVALID_DATA,"Expected Int64 or Number, found: "+e);var i=e.buffer.readUInt32BE(0,!0),r=e.buffer.readUInt32BE(4,!0),t=i>>>31;return i=(i<<1|r>>>31)^(t?4294967295:0),r=r<<1^(t?4294967295:0),new q(i,r)};f.prototype.i32ToZigzag=function(e){return e<<1^(e&2147483648?4294967295:0)};f.prototype.readMessageBegin=function(){var e=this.trans.readByte();if(e!=f.PROTOCOL_ID)throw new F.TProtocolException(F.TProtocolExceptionType.BAD_VERSION,"Bad protocol identifier "+e);var i=this.trans.readByte(),r=i&f.VERSION_MASK;if(r!=f.VERSION_N)throw new F.TProtocolException(F.TProtocolExceptionType.BAD_VERSION,"Bad protocol version "+r);var t=i>>f.TYPE_SHIFT_AMOUNT&f.TYPE_BITS,n=this.readVarint32(),s=this.readString();return{fname:s,mtype:t,rseqid:n}};f.prototype.readMessageEnd=function(){};f.prototype.readStructBegin=function(){return this.lastField_.push(this.lastFieldId_),this.lastFieldId_=0,{fname:""}};f.prototype.readStructEnd=function(){this.lastFieldId_=this.lastField_.pop()};f.prototype.readFieldBegin=function(){var e=0,i=this.trans.readByte(i),r=i&15;if(r==f.Types.CT_STOP)return{fname:null,ftype:F.Type.STOP,fid:0};var t=(i&240)>>>4;t===0?e=this.readI16():e=this.lastFieldId_+t;var n=this.getTType(r);return(r==f.Types.CT_BOOLEAN_TRUE||r==f.Types.CT_BOOLEAN_FALSE)&&(this.boolValue_.hasBoolValue=!0,this.boolValue_.boolValue=r==f.Types.CT_BOOLEAN_TRUE),this.lastFieldId_=e,{fname:null,ftype:n,fid:e}};f.prototype.readFieldEnd=function(){};f.prototype.readMapBegin=function(){var e=this.readVarint32();if(e<0)throw new F.TProtocolException(F.TProtocolExceptionType.NEGATIVE_SIZE,"Negative map size");var i=0;e!==0&&(i=this.trans.readByte());var r=this.getTType((i&240)>>>4),t=this.getTType(i&15);return{ktype:r,vtype:t,size:e}};f.prototype.readMapEnd=function(){};f.prototype.readListBegin=function(){var e=this.trans.readByte(),i=e>>>4&15;if(i==15&&(i=this.readVarint32()),i<0)throw new F.TProtocolException(F.TProtocolExceptionType.NEGATIVE_SIZE,"Negative list size");var r=this.getTType(e&15);return{etype:r,size:i}};f.prototype.readListEnd=function(){};f.prototype.readSetBegin=function(){return this.readListBegin()};f.prototype.readSetEnd=function(){};f.prototype.readBool=function(){var e=!1,i=0;if(this.boolValue_.hasBoolValue===!0)e=this.boolValue_.boolValue,this.boolValue_.hasBoolValue=!1;else{var r=this.trans.readByte();i=r.rsize,e=r.value==f.Types.CT_BOOLEAN_TRUE}return e};f.prototype.readByte=function(){return this.trans.readByte()};f.prototype.readI16=function(){return this.readI32()};f.prototype.readI32=function(){return this.zigzagToI32(this.readVarint32())};f.prototype.readI64=function(){return this.zigzagToI64(this.readVarint64())};f.prototype.readDouble=function(){var e=this.trans.read(8),i=0,r=e[i+7]&128,t=(e[i+6]&240)>>4;t+=(e[i+7]&127)<<4;var n=e[i];switch(n+=e[i+1]<<8,n+=e[i+2]<<16,n+=e[i+3]*sn,n+=e[i+4]*an,n+=e[i+5]*on,n+=(e[i+6]&15)*dn,t){case 0:t=-1022;break;case 2047:return n?NaN:r?-1/0:1/0;default:n+=ii,t-=1023}return r&&(n*=-1),n*Math.pow(2,t-52)};f.prototype.readBinary=function(){var e=this.readVarint32();if(e===0)return new Buffer(0);if(e<0)throw new F.TProtocolException(F.TProtocolExceptionType.NEGATIVE_SIZE,"Negative binary size");return this.trans.read(e)};f.prototype.readString=function(){var e=this.readVarint32();if(e===0)return"";if(e<0)throw new F.TProtocolException(F.TProtocolExceptionType.NEGATIVE_SIZE,"Negative string size");return this.trans.readString(e)};f.prototype.readVarint32=function(){return this.readVarint64().toNumber()};f.prototype.readVarint64=function(){for(var e=0,i=0,r=0,t=0;;){var n=this.trans.readByte();if(e++,t<=25?i=i|(n&127)<<t:25<t&&t<32?(i=i|(n&127)<<t,r=r|(n&127)>>>32-t):r=r|(n&127)<<t-32,t+=7,!(n&128))break;if(e>=10)throw new F.TProtocolException(F.TProtocolExceptionType.INVALID_DATA,"Variable-length int over 10 bytes.")}return new q(r,i)};f.prototype.zigzagToI32=function(e){return e>>>1^-1*(e&1)};f.prototype.zigzagToI64=function(e){var i=e.buffer.readUInt32BE(0,!0),r=e.buffer.readUInt32BE(4,!0),t=new q(i&0,r&1);t._2scomp();var n=t.buffer.readUInt32BE(0,!0),s=t.buffer.readUInt32BE(4,!0),o=i<<31;return i=i>>>1^n,r=(r>>>1|o)^s,new q(i,r)};f.prototype.skip=function(e){switch(e){case I.STOP:return;case I.BOOL:this.readBool();break;case I.BYTE:this.readByte();break;case I.I16:this.readI16();break;case I.I32:this.readI32();break;case I.I64:this.readI64();break;case I.DOUBLE:this.readDouble();break;case I.STRING:this.readString();break;case I.STRUCT:for(this.readStructBegin();;){var i=this.readFieldBegin();if(i.ftype===I.STOP)break;this.skip(i.ftype),this.readFieldEnd()}this.readStructEnd();break;case I.MAP:for(var r=this.readMapBegin(),t=0;t<r.size;++t)this.skip(r.ktype),this.skip(r.vtype);this.readMapEnd();break;case I.SET:for(var n=this.readSetBegin(),s=0;s<n.size;++s)this.skip(n.etype);this.readSetEnd();break;case I.LIST:for(var o=this.readListBegin(),l=0;l<o.size;++l)this.skip(o.etype);this.readListEnd();break;default:throw new Error("Invalid type: "+e)}}});var ti=T(te=>{te.Thrift=Ke();te.TFramedTransport=Vi();te.TBufferedTransport=Yi();te.TCompactProtocol=Ji()});var X=T((Qo,g)=>{var a=ti().Thrift,p=g.exports={};p.Type={BOOLEAN:0,INT32:1,INT64:2,INT96:3,FLOAT:4,DOUBLE:5,BYTE_ARRAY:6,FIXED_LEN_BYTE_ARRAY:7};p.ConvertedType={UTF8:0,MAP:1,MAP_KEY_VALUE:2,LIST:3,ENUM:4,DECIMAL:5,DATE:6,TIME_MILLIS:7,TIME_MICROS:8,TIMESTAMP_MILLIS:9,TIMESTAMP_MICROS:10,UINT_8:11,UINT_16:12,UINT_32:13,UINT_64:14,INT_8:15,INT_16:16,INT_32:17,INT_64:18,JSON:19,BSON:20,INTERVAL:21};p.FieldRepetitionType={REQUIRED:0,OPTIONAL:1,REPEATED:2};p.Encoding={PLAIN:0,PLAIN_DICTIONARY:2,RLE:3,BIT_PACKED:4,DELTA_BINARY_PACKED:5,DELTA_LENGTH_BYTE_ARRAY:6,DELTA_BYTE_ARRAY:7,RLE_DICTIONARY:8};p.CompressionCodec={UNCOMPRESSED:0,SNAPPY:1,GZIP:2,LZO:3,BROTLI:4,LZ4:5,ZSTD:6};p.PageType={DATA_PAGE:0,INDEX_PAGE:1,DICTIONARY_PAGE:2,DATA_PAGE_V2:3};p.BoundaryOrder={UNORDERED:0,ASCENDING:1,DESCENDING:2};Statistics=g.exports.Statistics=function(e){this.max=null,this.min=null,this.null_count=null,this.distinct_count=null,this.max_value=null,this.min_value=null,e&&(e.max!==void 0&&(this.max=e.max),e.min!==void 0&&(this.min=e.min),e.null_count!==void 0&&(this.null_count=e.null_count),e.distinct_count!==void 0&&(this.distinct_count=e.distinct_count),e.max_value!==void 0&&(this.max_value=e.max_value),e.min_value!==void 0&&(this.min_value=e.min_value))};Statistics.prototype={};Statistics.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRING?this.max=e.readString():e.skip(t);break;case 2:t==a.Type.STRING?this.min=e.readString():e.skip(t);break;case 3:t==a.Type.I64?this.null_count=e.readI64():e.skip(t);break;case 4:t==a.Type.I64?this.distinct_count=e.readI64():e.skip(t);break;case 5:t==a.Type.STRING?this.max_value=e.readString():e.skip(t);break;case 6:t==a.Type.STRING?this.min_value=e.readString():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};Statistics.prototype.write=function(e){e.writeStructBegin("Statistics"),this.max!==null&&this.max!==void 0&&(e.writeFieldBegin("max",a.Type.STRING,1),e.writeString(this.max),e.writeFieldEnd()),this.min!==null&&this.min!==void 0&&(e.writeFieldBegin("min",a.Type.STRING,2),e.writeString(this.min),e.writeFieldEnd()),this.null_count!==null&&this.null_count!==void 0&&(e.writeFieldBegin("null_count",a.Type.I64,3),e.writeI64(this.null_count),e.writeFieldEnd()),this.distinct_count!==null&&this.distinct_count!==void 0&&(e.writeFieldBegin("distinct_count",a.Type.I64,4),e.writeI64(this.distinct_count),e.writeFieldEnd()),this.max_value!==null&&this.max_value!==void 0&&(e.writeFieldBegin("max_value",a.Type.STRING,5),e.writeString(this.max_value),e.writeFieldEnd()),this.min_value!==null&&this.min_value!==void 0&&(e.writeFieldBegin("min_value",a.Type.STRING,6),e.writeString(this.min_value),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};StringType=g.exports.StringType=function(e){};StringType.prototype={};StringType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};StringType.prototype.write=function(e){e.writeStructBegin("StringType"),e.writeFieldStop(),e.writeStructEnd()};UUIDType=g.exports.UUIDType=function(e){};UUIDType.prototype={};UUIDType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};UUIDType.prototype.write=function(e){e.writeStructBegin("UUIDType"),e.writeFieldStop(),e.writeStructEnd()};MapType=g.exports.MapType=function(e){};MapType.prototype={};MapType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};MapType.prototype.write=function(e){e.writeStructBegin("MapType"),e.writeFieldStop(),e.writeStructEnd()};ListType=g.exports.ListType=function(e){};ListType.prototype={};ListType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};ListType.prototype.write=function(e){e.writeStructBegin("ListType"),e.writeFieldStop(),e.writeStructEnd()};EnumType=g.exports.EnumType=function(e){};EnumType.prototype={};EnumType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};EnumType.prototype.write=function(e){e.writeStructBegin("EnumType"),e.writeFieldStop(),e.writeStructEnd()};DateType=g.exports.DateType=function(e){};DateType.prototype={};DateType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};DateType.prototype.write=function(e){e.writeStructBegin("DateType"),e.writeFieldStop(),e.writeStructEnd()};NullType=g.exports.NullType=function(e){};NullType.prototype={};NullType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};NullType.prototype.write=function(e){e.writeStructBegin("NullType"),e.writeFieldStop(),e.writeStructEnd()};DecimalType=g.exports.DecimalType=function(e){this.scale=null,this.precision=null,e&&(e.scale!==void 0&&(this.scale=e.scale),e.precision!==void 0&&(this.precision=e.precision))};DecimalType.prototype={};DecimalType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.scale=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.precision=e.readI32():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};DecimalType.prototype.write=function(e){e.writeStructBegin("DecimalType"),this.scale!==null&&this.scale!==void 0&&(e.writeFieldBegin("scale",a.Type.I32,1),e.writeI32(this.scale),e.writeFieldEnd()),this.precision!==null&&this.precision!==void 0&&(e.writeFieldBegin("precision",a.Type.I32,2),e.writeI32(this.precision),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};MilliSeconds=g.exports.MilliSeconds=function(e){};MilliSeconds.prototype={};MilliSeconds.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};MilliSeconds.prototype.write=function(e){e.writeStructBegin("MilliSeconds"),e.writeFieldStop(),e.writeStructEnd()};MicroSeconds=g.exports.MicroSeconds=function(e){};MicroSeconds.prototype={};MicroSeconds.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};MicroSeconds.prototype.write=function(e){e.writeStructBegin("MicroSeconds"),e.writeFieldStop(),e.writeStructEnd()};TimeUnit=g.exports.TimeUnit=function(e){this.MILLIS=null,this.MICROS=null,e&&(e.MILLIS!==void 0&&(this.MILLIS=e.MILLIS),e.MICROS!==void 0&&(this.MICROS=e.MICROS))};TimeUnit.prototype={};TimeUnit.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRUCT?(this.MILLIS=new p.MilliSeconds,this.MILLIS.read(e)):e.skip(t);break;case 2:t==a.Type.STRUCT?(this.MICROS=new p.MicroSeconds,this.MICROS.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};TimeUnit.prototype.write=function(e){e.writeStructBegin("TimeUnit"),this.MILLIS!==null&&this.MILLIS!==void 0&&(e.writeFieldBegin("MILLIS",a.Type.STRUCT,1),this.MILLIS.write(e),e.writeFieldEnd()),this.MICROS!==null&&this.MICROS!==void 0&&(e.writeFieldBegin("MICROS",a.Type.STRUCT,2),this.MICROS.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};TimestampType=g.exports.TimestampType=function(e){this.isAdjustedToUTC=null,this.unit=null,e&&(e.isAdjustedToUTC!==void 0&&(this.isAdjustedToUTC=e.isAdjustedToUTC),e.unit!==void 0&&(this.unit=e.unit))};TimestampType.prototype={};TimestampType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.BOOL?this.isAdjustedToUTC=e.readBool():e.skip(t);break;case 2:t==a.Type.STRUCT?(this.unit=new p.TimeUnit,this.unit.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};TimestampType.prototype.write=function(e){e.writeStructBegin("TimestampType"),this.isAdjustedToUTC!==null&&this.isAdjustedToUTC!==void 0&&(e.writeFieldBegin("isAdjustedToUTC",a.Type.BOOL,1),e.writeBool(this.isAdjustedToUTC),e.writeFieldEnd()),this.unit!==null&&this.unit!==void 0&&(e.writeFieldBegin("unit",a.Type.STRUCT,2),this.unit.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};TimeType=g.exports.TimeType=function(e){this.isAdjustedToUTC=null,this.unit=null,e&&(e.isAdjustedToUTC!==void 0&&(this.isAdjustedToUTC=e.isAdjustedToUTC),e.unit!==void 0&&(this.unit=e.unit))};TimeType.prototype={};TimeType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.BOOL?this.isAdjustedToUTC=e.readBool():e.skip(t);break;case 2:t==a.Type.STRUCT?(this.unit=new p.TimeUnit,this.unit.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};TimeType.prototype.write=function(e){e.writeStructBegin("TimeType"),this.isAdjustedToUTC!==null&&this.isAdjustedToUTC!==void 0&&(e.writeFieldBegin("isAdjustedToUTC",a.Type.BOOL,1),e.writeBool(this.isAdjustedToUTC),e.writeFieldEnd()),this.unit!==null&&this.unit!==void 0&&(e.writeFieldBegin("unit",a.Type.STRUCT,2),this.unit.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};IntType=g.exports.IntType=function(e){this.bitWidth=null,this.isSigned=null,e&&(e.bitWidth!==void 0&&(this.bitWidth=e.bitWidth),e.isSigned!==void 0&&(this.isSigned=e.isSigned))};IntType.prototype={};IntType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.BYTE?this.bitWidth=e.readByte():e.skip(t);break;case 2:t==a.Type.BOOL?this.isSigned=e.readBool():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};IntType.prototype.write=function(e){e.writeStructBegin("IntType"),this.bitWidth!==null&&this.bitWidth!==void 0&&(e.writeFieldBegin("bitWidth",a.Type.BYTE,1),e.writeByte(this.bitWidth),e.writeFieldEnd()),this.isSigned!==null&&this.isSigned!==void 0&&(e.writeFieldBegin("isSigned",a.Type.BOOL,2),e.writeBool(this.isSigned),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};JsonType=g.exports.JsonType=function(e){};JsonType.prototype={};JsonType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};JsonType.prototype.write=function(e){e.writeStructBegin("JsonType"),e.writeFieldStop(),e.writeStructEnd()};BsonType=g.exports.BsonType=function(e){};BsonType.prototype={};BsonType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};BsonType.prototype.write=function(e){e.writeStructBegin("BsonType"),e.writeFieldStop(),e.writeStructEnd()};LogicalType=g.exports.LogicalType=function(e){this.STRING=null,this.MAP=null,this.LIST=null,this.ENUM=null,this.DECIMAL=null,this.DATE=null,this.TIME=null,this.TIMESTAMP=null,this.INTEGER=null,this.UNKNOWN=null,this.JSON=null,this.BSON=null,e&&(e.STRING!==void 0&&(this.STRING=e.STRING),e.MAP!==void 0&&(this.MAP=e.MAP),e.LIST!==void 0&&(this.LIST=e.LIST),e.ENUM!==void 0&&(this.ENUM=e.ENUM),e.DECIMAL!==void 0&&(this.DECIMAL=e.DECIMAL),e.DATE!==void 0&&(this.DATE=e.DATE),e.TIME!==void 0&&(this.TIME=e.TIME),e.TIMESTAMP!==void 0&&(this.TIMESTAMP=e.TIMESTAMP),e.INTEGER!==void 0&&(this.INTEGER=e.INTEGER),e.UNKNOWN!==void 0&&(this.UNKNOWN=e.UNKNOWN),e.JSON!==void 0&&(this.JSON=e.JSON),e.BSON!==void 0&&(this.BSON=e.BSON))};LogicalType.prototype={};LogicalType.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRUCT?(this.STRING=new p.StringType,this.STRING.read(e)):e.skip(t);break;case 2:t==a.Type.STRUCT?(this.MAP=new p.MapType,this.MAP.read(e)):e.skip(t);break;case 3:t==a.Type.STRUCT?(this.LIST=new p.ListType,this.LIST.read(e)):e.skip(t);break;case 4:t==a.Type.STRUCT?(this.ENUM=new p.EnumType,this.ENUM.read(e)):e.skip(t);break;case 5:t==a.Type.STRUCT?(this.DECIMAL=new p.DecimalType,this.DECIMAL.read(e)):e.skip(t);break;case 6:t==a.Type.STRUCT?(this.DATE=new p.DateType,this.DATE.read(e)):e.skip(t);break;case 7:t==a.Type.STRUCT?(this.TIME=new p.TimeType,this.TIME.read(e)):e.skip(t);break;case 8:t==a.Type.STRUCT?(this.TIMESTAMP=new p.TimestampType,this.TIMESTAMP.read(e)):e.skip(t);break;case 10:t==a.Type.STRUCT?(this.INTEGER=new p.IntType,this.INTEGER.read(e)):e.skip(t);break;case 11:t==a.Type.STRUCT?(this.UNKNOWN=new p.NullType,this.UNKNOWN.read(e)):e.skip(t);break;case 12:t==a.Type.STRUCT?(this.JSON=new p.JsonType,this.JSON.read(e)):e.skip(t);break;case 13:t==a.Type.STRUCT?(this.BSON=new p.BsonType,this.BSON.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};LogicalType.prototype.write=function(e){e.writeStructBegin("LogicalType"),this.STRING!==null&&this.STRING!==void 0&&(e.writeFieldBegin("STRING",a.Type.STRUCT,1),this.STRING.write(e),e.writeFieldEnd()),this.MAP!==null&&this.MAP!==void 0&&(e.writeFieldBegin("MAP",a.Type.STRUCT,2),this.MAP.write(e),e.writeFieldEnd()),this.LIST!==null&&this.LIST!==void 0&&(e.writeFieldBegin("LIST",a.Type.STRUCT,3),this.LIST.write(e),e.writeFieldEnd()),this.ENUM!==null&&this.ENUM!==void 0&&(e.writeFieldBegin("ENUM",a.Type.STRUCT,4),this.ENUM.write(e),e.writeFieldEnd()),this.DECIMAL!==null&&this.DECIMAL!==void 0&&(e.writeFieldBegin("DECIMAL",a.Type.STRUCT,5),this.DECIMAL.write(e),e.writeFieldEnd()),this.DATE!==null&&this.DATE!==void 0&&(e.writeFieldBegin("DATE",a.Type.STRUCT,6),this.DATE.write(e),e.writeFieldEnd()),this.TIME!==null&&this.TIME!==void 0&&(e.writeFieldBegin("TIME",a.Type.STRUCT,7),this.TIME.write(e),e.writeFieldEnd()),this.TIMESTAMP!==null&&this.TIMESTAMP!==void 0&&(e.writeFieldBegin("TIMESTAMP",a.Type.STRUCT,8),this.TIMESTAMP.write(e),e.writeFieldEnd()),this.INTEGER!==null&&this.INTEGER!==void 0&&(e.writeFieldBegin("INTEGER",a.Type.STRUCT,10),this.INTEGER.write(e),e.writeFieldEnd()),this.UNKNOWN!==null&&this.UNKNOWN!==void 0&&(e.writeFieldBegin("UNKNOWN",a.Type.STRUCT,11),this.UNKNOWN.write(e),e.writeFieldEnd()),this.JSON!==null&&this.JSON!==void 0&&(e.writeFieldBegin("JSON",a.Type.STRUCT,12),this.JSON.write(e),e.writeFieldEnd()),this.BSON!==null&&this.BSON!==void 0&&(e.writeFieldBegin("BSON",a.Type.STRUCT,13),this.BSON.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};SchemaElement=g.exports.SchemaElement=function(e){this.type=null,this.type_length=null,this.repetition_type=null,this.name=null,this.num_children=null,this.converted_type=null,this.scale=null,this.precision=null,this.field_id=null,this.logicalType=null,e&&(e.type!==void 0&&(this.type=e.type),e.type_length!==void 0&&(this.type_length=e.type_length),e.repetition_type!==void 0&&(this.repetition_type=e.repetition_type),e.name!==void 0&&(this.name=e.name),e.num_children!==void 0&&(this.num_children=e.num_children),e.converted_type!==void 0&&(this.converted_type=e.converted_type),e.scale!==void 0&&(this.scale=e.scale),e.precision!==void 0&&(this.precision=e.precision),e.field_id!==void 0&&(this.field_id=e.field_id),e.logicalType!==void 0&&(this.logicalType=e.logicalType))};SchemaElement.prototype={};SchemaElement.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.type=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.type_length=e.readI32():e.skip(t);break;case 3:t==a.Type.I32?this.repetition_type=e.readI32():e.skip(t);break;case 4:t==a.Type.STRING?this.name=e.readString():e.skip(t);break;case 5:t==a.Type.I32?this.num_children=e.readI32():e.skip(t);break;case 6:t==a.Type.I32?this.converted_type=e.readI32():e.skip(t);break;case 7:t==a.Type.I32?this.scale=e.readI32():e.skip(t);break;case 8:t==a.Type.I32?this.precision=e.readI32():e.skip(t);break;case 9:t==a.Type.I32?this.field_id=e.readI32():e.skip(t);break;case 10:t==a.Type.STRUCT?(this.logicalType=new p.LogicalType,this.logicalType.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};SchemaElement.prototype.write=function(e){e.writeStructBegin("SchemaElement"),this.type!==null&&this.type!==void 0&&(e.writeFieldBegin("type",a.Type.I32,1),e.writeI32(this.type),e.writeFieldEnd()),this.type_length!==null&&this.type_length!==void 0&&(e.writeFieldBegin("type_length",a.Type.I32,2),e.writeI32(this.type_length),e.writeFieldEnd()),this.repetition_type!==null&&this.repetition_type!==void 0&&(e.writeFieldBegin("repetition_type",a.Type.I32,3),e.writeI32(this.repetition_type),e.writeFieldEnd()),this.name!==null&&this.name!==void 0&&(e.writeFieldBegin("name",a.Type.STRING,4),e.writeString(this.name),e.writeFieldEnd()),this.num_children!==null&&this.num_children!==void 0&&(e.writeFieldBegin("num_children",a.Type.I32,5),e.writeI32(this.num_children),e.writeFieldEnd()),this.converted_type!==null&&this.converted_type!==void 0&&(e.writeFieldBegin("converted_type",a.Type.I32,6),e.writeI32(this.converted_type),e.writeFieldEnd()),this.scale!==null&&this.scale!==void 0&&(e.writeFieldBegin("scale",a.Type.I32,7),e.writeI32(this.scale),e.writeFieldEnd()),this.precision!==null&&this.precision!==void 0&&(e.writeFieldBegin("precision",a.Type.I32,8),e.writeI32(this.precision),e.writeFieldEnd()),this.field_id!==null&&this.field_id!==void 0&&(e.writeFieldBegin("field_id",a.Type.I32,9),e.writeI32(this.field_id),e.writeFieldEnd()),this.logicalType!==null&&this.logicalType!==void 0&&(e.writeFieldBegin("logicalType",a.Type.STRUCT,10),this.logicalType.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};DataPageHeader=g.exports.DataPageHeader=function(e){this.num_values=null,this.encoding=null,this.definition_level_encoding=null,this.repetition_level_encoding=null,this.statistics=null,e&&(e.num_values!==void 0&&(this.num_values=e.num_values),e.encoding!==void 0&&(this.encoding=e.encoding),e.definition_level_encoding!==void 0&&(this.definition_level_encoding=e.definition_level_encoding),e.repetition_level_encoding!==void 0&&(this.repetition_level_encoding=e.repetition_level_encoding),e.statistics!==void 0&&(this.statistics=e.statistics))};DataPageHeader.prototype={};DataPageHeader.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.num_values=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.encoding=e.readI32():e.skip(t);break;case 3:t==a.Type.I32?this.definition_level_encoding=e.readI32():e.skip(t);break;case 4:t==a.Type.I32?this.repetition_level_encoding=e.readI32():e.skip(t);break;case 5:t==a.Type.STRUCT?(this.statistics=new p.Statistics,this.statistics.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};DataPageHeader.prototype.write=function(e){e.writeStructBegin("DataPageHeader"),this.num_values!==null&&this.num_values!==void 0&&(e.writeFieldBegin("num_values",a.Type.I32,1),e.writeI32(this.num_values),e.writeFieldEnd()),this.encoding!==null&&this.encoding!==void 0&&(e.writeFieldBegin("encoding",a.Type.I32,2),e.writeI32(this.encoding),e.writeFieldEnd()),this.definition_level_encoding!==null&&this.definition_level_encoding!==void 0&&(e.writeFieldBegin("definition_level_encoding",a.Type.I32,3),e.writeI32(this.definition_level_encoding),e.writeFieldEnd()),this.repetition_level_encoding!==null&&this.repetition_level_encoding!==void 0&&(e.writeFieldBegin("repetition_level_encoding",a.Type.I32,4),e.writeI32(this.repetition_level_encoding),e.writeFieldEnd()),this.statistics!==null&&this.statistics!==void 0&&(e.writeFieldBegin("statistics",a.Type.STRUCT,5),this.statistics.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};IndexPageHeader=g.exports.IndexPageHeader=function(e){};IndexPageHeader.prototype={};IndexPageHeader.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};IndexPageHeader.prototype.write=function(e){e.writeStructBegin("IndexPageHeader"),e.writeFieldStop(),e.writeStructEnd()};DictionaryPageHeader=g.exports.DictionaryPageHeader=function(e){this.num_values=null,this.encoding=null,this.is_sorted=null,e&&(e.num_values!==void 0&&(this.num_values=e.num_values),e.encoding!==void 0&&(this.encoding=e.encoding),e.is_sorted!==void 0&&(this.is_sorted=e.is_sorted))};DictionaryPageHeader.prototype={};DictionaryPageHeader.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.num_values=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.encoding=e.readI32():e.skip(t);break;case 3:t==a.Type.BOOL?this.is_sorted=e.readBool():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};DictionaryPageHeader.prototype.write=function(e){e.writeStructBegin("DictionaryPageHeader"),this.num_values!==null&&this.num_values!==void 0&&(e.writeFieldBegin("num_values",a.Type.I32,1),e.writeI32(this.num_values),e.writeFieldEnd()),this.encoding!==null&&this.encoding!==void 0&&(e.writeFieldBegin("encoding",a.Type.I32,2),e.writeI32(this.encoding),e.writeFieldEnd()),this.is_sorted!==null&&this.is_sorted!==void 0&&(e.writeFieldBegin("is_sorted",a.Type.BOOL,3),e.writeBool(this.is_sorted),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};DataPageHeaderV2=g.exports.DataPageHeaderV2=function(e){this.num_values=null,this.num_nulls=null,this.num_rows=null,this.encoding=null,this.definition_levels_byte_length=null,this.repetition_levels_byte_length=null,this.is_compressed=!0,this.statistics=null,e&&(e.num_values!==void 0&&(this.num_values=e.num_values),e.num_nulls!==void 0&&(this.num_nulls=e.num_nulls),e.num_rows!==void 0&&(this.num_rows=e.num_rows),e.encoding!==void 0&&(this.encoding=e.encoding),e.definition_levels_byte_length!==void 0&&(this.definition_levels_byte_length=e.definition_levels_byte_length),e.repetition_levels_byte_length!==void 0&&(this.repetition_levels_byte_length=e.repetition_levels_byte_length),e.is_compressed!==void 0&&(this.is_compressed=e.is_compressed),e.statistics!==void 0&&(this.statistics=e.statistics))};DataPageHeaderV2.prototype={};DataPageHeaderV2.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.num_values=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.num_nulls=e.readI32():e.skip(t);break;case 3:t==a.Type.I32?this.num_rows=e.readI32():e.skip(t);break;case 4:t==a.Type.I32?this.encoding=e.readI32():e.skip(t);break;case 5:t==a.Type.I32?this.definition_levels_byte_length=e.readI32():e.skip(t);break;case 6:t==a.Type.I32?this.repetition_levels_byte_length=e.readI32():e.skip(t);break;case 7:t==a.Type.BOOL?this.is_compressed=e.readBool():e.skip(t);break;case 8:t==a.Type.STRUCT?(this.statistics=new p.Statistics,this.statistics.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};DataPageHeaderV2.prototype.write=function(e){e.writeStructBegin("DataPageHeaderV2"),this.num_values!==null&&this.num_values!==void 0&&(e.writeFieldBegin("num_values",a.Type.I32,1),e.writeI32(this.num_values),e.writeFieldEnd()),this.num_nulls!==null&&this.num_nulls!==void 0&&(e.writeFieldBegin("num_nulls",a.Type.I32,2),e.writeI32(this.num_nulls),e.writeFieldEnd()),this.num_rows!==null&&this.num_rows!==void 0&&(e.writeFieldBegin("num_rows",a.Type.I32,3),e.writeI32(this.num_rows),e.writeFieldEnd()),this.encoding!==null&&this.encoding!==void 0&&(e.writeFieldBegin("encoding",a.Type.I32,4),e.writeI32(this.encoding),e.writeFieldEnd()),this.definition_levels_byte_length!==null&&this.definition_levels_byte_length!==void 0&&(e.writeFieldBegin("definition_levels_byte_length",a.Type.I32,5),e.writeI32(this.definition_levels_byte_length),e.writeFieldEnd()),this.repetition_levels_byte_length!==null&&this.repetition_levels_byte_length!==void 0&&(e.writeFieldBegin("repetition_levels_byte_length",a.Type.I32,6),e.writeI32(this.repetition_levels_byte_length),e.writeFieldEnd()),this.is_compressed!==null&&this.is_compressed!==void 0&&(e.writeFieldBegin("is_compressed",a.Type.BOOL,7),e.writeBool(this.is_compressed),e.writeFieldEnd()),this.statistics!==null&&this.statistics!==void 0&&(e.writeFieldBegin("statistics",a.Type.STRUCT,8),this.statistics.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};PageHeader=g.exports.PageHeader=function(e){this.type=null,this.uncompressed_page_size=null,this.compressed_page_size=null,this.crc=null,this.data_page_header=null,this.index_page_header=null,this.dictionary_page_header=null,this.data_page_header_v2=null,e&&(e.type!==void 0&&(this.type=e.type),e.uncompressed_page_size!==void 0&&(this.uncompressed_page_size=e.uncompressed_page_size),e.compressed_page_size!==void 0&&(this.compressed_page_size=e.compressed_page_size),e.crc!==void 0&&(this.crc=e.crc),e.data_page_header!==void 0&&(this.data_page_header=e.data_page_header),e.index_page_header!==void 0&&(this.index_page_header=e.index_page_header),e.dictionary_page_header!==void 0&&(this.dictionary_page_header=e.dictionary_page_header),e.data_page_header_v2!==void 0&&(this.data_page_header_v2=e.data_page_header_v2))};PageHeader.prototype={};PageHeader.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.type=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.uncompressed_page_size=e.readI32():e.skip(t);break;case 3:t==a.Type.I32?this.compressed_page_size=e.readI32():e.skip(t);break;case 4:t==a.Type.I32?this.crc=e.readI32():e.skip(t);break;case 5:t==a.Type.STRUCT?(this.data_page_header=new p.DataPageHeader,this.data_page_header.read(e)):e.skip(t);break;case 6:t==a.Type.STRUCT?(this.index_page_header=new p.IndexPageHeader,this.index_page_header.read(e)):e.skip(t);break;case 7:t==a.Type.STRUCT?(this.dictionary_page_header=new p.DictionaryPageHeader,this.dictionary_page_header.read(e)):e.skip(t);break;case 8:t==a.Type.STRUCT?(this.data_page_header_v2=new p.DataPageHeaderV2,this.data_page_header_v2.read(e)):e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};PageHeader.prototype.write=function(e){e.writeStructBegin("PageHeader"),this.type!==null&&this.type!==void 0&&(e.writeFieldBegin("type",a.Type.I32,1),e.writeI32(this.type),e.writeFieldEnd()),this.uncompressed_page_size!==null&&this.uncompressed_page_size!==void 0&&(e.writeFieldBegin("uncompressed_page_size",a.Type.I32,2),e.writeI32(this.uncompressed_page_size),e.writeFieldEnd()),this.compressed_page_size!==null&&this.compressed_page_size!==void 0&&(e.writeFieldBegin("compressed_page_size",a.Type.I32,3),e.writeI32(this.compressed_page_size),e.writeFieldEnd()),this.crc!==null&&this.crc!==void 0&&(e.writeFieldBegin("crc",a.Type.I32,4),e.writeI32(this.crc),e.writeFieldEnd()),this.data_page_header!==null&&this.data_page_header!==void 0&&(e.writeFieldBegin("data_page_header",a.Type.STRUCT,5),this.data_page_header.write(e),e.writeFieldEnd()),this.index_page_header!==null&&this.index_page_header!==void 0&&(e.writeFieldBegin("index_page_header",a.Type.STRUCT,6),this.index_page_header.write(e),e.writeFieldEnd()),this.dictionary_page_header!==null&&this.dictionary_page_header!==void 0&&(e.writeFieldBegin("dictionary_page_header",a.Type.STRUCT,7),this.dictionary_page_header.write(e),e.writeFieldEnd()),this.data_page_header_v2!==null&&this.data_page_header_v2!==void 0&&(e.writeFieldBegin("data_page_header_v2",a.Type.STRUCT,8),this.data_page_header_v2.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};KeyValue=g.exports.KeyValue=function(e){this.key=null,this.value=null,e&&(e.key!==void 0&&(this.key=e.key),e.value!==void 0&&(this.value=e.value))};KeyValue.prototype={};KeyValue.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRING?this.key=e.readString():e.skip(t);break;case 2:t==a.Type.STRING?this.value=e.readString():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};KeyValue.prototype.write=function(e){e.writeStructBegin("KeyValue"),this.key!==null&&this.key!==void 0&&(e.writeFieldBegin("key",a.Type.STRING,1),e.writeString(this.key),e.writeFieldEnd()),this.value!==null&&this.value!==void 0&&(e.writeFieldBegin("value",a.Type.STRING,2),e.writeString(this.value),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};SortingColumn=g.exports.SortingColumn=function(e){this.column_idx=null,this.descending=null,this.nulls_first=null,e&&(e.column_idx!==void 0&&(this.column_idx=e.column_idx),e.descending!==void 0&&(this.descending=e.descending),e.nulls_first!==void 0&&(this.nulls_first=e.nulls_first))};SortingColumn.prototype={};SortingColumn.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.column_idx=e.readI32():e.skip(t);break;case 2:t==a.Type.BOOL?this.descending=e.readBool():e.skip(t);break;case 3:t==a.Type.BOOL?this.nulls_first=e.readBool():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};SortingColumn.prototype.write=function(e){e.writeStructBegin("SortingColumn"),this.column_idx!==null&&this.column_idx!==void 0&&(e.writeFieldBegin("column_idx",a.Type.I32,1),e.writeI32(this.column_idx),e.writeFieldEnd()),this.descending!==null&&this.descending!==void 0&&(e.writeFieldBegin("descending",a.Type.BOOL,2),e.writeBool(this.descending),e.writeFieldEnd()),this.nulls_first!==null&&this.nulls_first!==void 0&&(e.writeFieldBegin("nulls_first",a.Type.BOOL,3),e.writeBool(this.nulls_first),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};PageEncodingStats=g.exports.PageEncodingStats=function(e){this.page_type=null,this.encoding=null,this.count=null,e&&(e.page_type!==void 0&&(this.page_type=e.page_type),e.encoding!==void 0&&(this.encoding=e.encoding),e.count!==void 0&&(this.count=e.count))};PageEncodingStats.prototype={};PageEncodingStats.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.page_type=e.readI32():e.skip(t);break;case 2:t==a.Type.I32?this.encoding=e.readI32():e.skip(t);break;case 3:t==a.Type.I32?this.count=e.readI32():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};PageEncodingStats.prototype.write=function(e){e.writeStructBegin("PageEncodingStats"),this.page_type!==null&&this.page_type!==void 0&&(e.writeFieldBegin("page_type",a.Type.I32,1),e.writeI32(this.page_type),e.writeFieldEnd()),this.encoding!==null&&this.encoding!==void 0&&(e.writeFieldBegin("encoding",a.Type.I32,2),e.writeI32(this.encoding),e.writeFieldEnd()),this.count!==null&&this.count!==void 0&&(e.writeFieldBegin("count",a.Type.I32,3),e.writeI32(this.count),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};ColumnMetaData=g.exports.ColumnMetaData=function(e){this.type=null,this.encodings=null,this.path_in_schema=null,this.codec=null,this.num_values=null,this.total_uncompressed_size=null,this.total_compressed_size=null,this.key_value_metadata=null,this.data_page_offset=null,this.index_page_offset=null,this.dictionary_page_offset=null,this.statistics=null,this.encoding_stats=null,e&&(e.type!==void 0&&(this.type=e.type),e.encodings!==void 0&&(this.encodings=e.encodings),e.path_in_schema!==void 0&&(this.path_in_schema=e.path_in_schema),e.codec!==void 0&&(this.codec=e.codec),e.num_values!==void 0&&(this.num_values=e.num_values),e.total_uncompressed_size!==void 0&&(this.total_uncompressed_size=e.total_uncompressed_size),e.total_compressed_size!==void 0&&(this.total_compressed_size=e.total_compressed_size),e.key_value_metadata!==void 0&&(this.key_value_metadata=e.key_value_metadata),e.data_page_offset!==void 0&&(this.data_page_offset=e.data_page_offset),e.index_page_offset!==void 0&&(this.index_page_offset=e.index_page_offset),e.dictionary_page_offset!==void 0&&(this.dictionary_page_offset=e.dictionary_page_offset),e.statistics!==void 0&&(this.statistics=e.statistics),e.encoding_stats!==void 0&&(this.encoding_stats=e.encoding_stats))};ColumnMetaData.prototype={};ColumnMetaData.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.type=e.readI32():e.skip(t);break;case 2:if(t==a.Type.LIST){var s=0,o;this.encodings=[];var l=0;o=e.readListBegin(),l=o.etype,s=o.size;for(var c=0;c<s;++c){var h=null;h=e.readI32(),this.encodings.push(h)}e.readListEnd()}else e.skip(t);break;case 3:if(t==a.Type.LIST){var u=0,_;this.path_in_schema=[];var y=0;_=e.readListBegin(),y=_.etype,u=_.size;for(var w=0;w<u;++w){var m=null;m=e.readString(),this.path_in_schema.push(m)}e.readListEnd()}else e.skip(t);break;case 4:t==a.Type.I32?this.codec=e.readI32():e.skip(t);break;case 5:t==a.Type.I64?this.num_values=e.readI64():e.skip(t);break;case 6:t==a.Type.I64?this.total_uncompressed_size=e.readI64():e.skip(t);break;case 7:t==a.Type.I64?this.total_compressed_size=e.readI64():e.skip(t);break;case 8:if(t==a.Type.LIST){var v=0,S;this.key_value_metadata=[];var U=0;S=e.readListBegin(),U=S.etype,v=S.size;for(var k=0;k<v;++k){var O=null;O=new p.KeyValue,O.read(e),this.key_value_metadata.push(O)}e.readListEnd()}else e.skip(t);break;case 9:t==a.Type.I64?this.data_page_offset=e.readI64():e.skip(t);break;case 10:t==a.Type.I64?this.index_page_offset=e.readI64():e.skip(t);break;case 11:t==a.Type.I64?this.dictionary_page_offset=e.readI64():e.skip(t);break;case 12:t==a.Type.STRUCT?(this.statistics=new p.Statistics,this.statistics.read(e)):e.skip(t);break;case 13:if(t==a.Type.LIST){var P=0,A;this.encoding_stats=[];var G=0;A=e.readListBegin(),G=A.etype,P=A.size;for(var M=0;M<P;++M){var b=null;b=new p.PageEncodingStats,b.read(e),this.encoding_stats.push(b)}e.readListEnd()}else e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};ColumnMetaData.prototype.write=function(e){if(e.writeStructBegin("ColumnMetaData"),this.type!==null&&this.type!==void 0&&(e.writeFieldBegin("type",a.Type.I32,1),e.writeI32(this.type),e.writeFieldEnd()),this.encodings!==null&&this.encodings!==void 0){e.writeFieldBegin("encodings",a.Type.LIST,2),e.writeListBegin(a.Type.I32,this.encodings.length);for(var i in this.encodings)this.encodings.hasOwnProperty(i)&&(i=this.encodings[i],e.writeI32(i));e.writeListEnd(),e.writeFieldEnd()}if(this.path_in_schema!==null&&this.path_in_schema!==void 0){e.writeFieldBegin("path_in_schema",a.Type.LIST,3),e.writeListBegin(a.Type.STRING,this.path_in_schema.length);for(var r in this.path_in_schema)this.path_in_schema.hasOwnProperty(r)&&(r=this.path_in_schema[r],e.writeString(r));e.writeListEnd(),e.writeFieldEnd()}if(this.codec!==null&&this.codec!==void 0&&(e.writeFieldBegin("codec",a.Type.I32,4),e.writeI32(this.codec),e.writeFieldEnd()),this.num_values!==null&&this.num_values!==void 0&&(e.writeFieldBegin("num_values",a.Type.I64,5),e.writeI64(this.num_values),e.writeFieldEnd()),this.total_uncompressed_size!==null&&this.total_uncompressed_size!==void 0&&(e.writeFieldBegin("total_uncompressed_size",a.Type.I64,6),e.writeI64(this.total_uncompressed_size),e.writeFieldEnd()),this.total_compressed_size!==null&&this.total_compressed_size!==void 0&&(e.writeFieldBegin("total_compressed_size",a.Type.I64,7),e.writeI64(this.total_compressed_size),e.writeFieldEnd()),this.key_value_metadata!==null&&this.key_value_metadata!==void 0){e.writeFieldBegin("key_value_metadata",a.Type.LIST,8),e.writeListBegin(a.Type.STRUCT,this.key_value_metadata.length);for(var t in this.key_value_metadata)this.key_value_metadata.hasOwnProperty(t)&&(t=this.key_value_metadata[t],t.write(e));e.writeListEnd(),e.writeFieldEnd()}if(this.data_page_offset!==null&&this.data_page_offset!==void 0&&(e.writeFieldBegin("data_page_offset",a.Type.I64,9),e.writeI64(this.data_page_offset),e.writeFieldEnd()),this.index_page_offset!==null&&this.index_page_offset!==void 0&&(e.writeFieldBegin("index_page_offset",a.Type.I64,10),e.writeI64(this.index_page_offset),e.writeFieldEnd()),this.dictionary_page_offset!==null&&this.dictionary_page_offset!==void 0&&(e.writeFieldBegin("dictionary_page_offset",a.Type.I64,11),e.writeI64(this.dictionary_page_offset),e.writeFieldEnd()),this.statistics!==null&&this.statistics!==void 0&&(e.writeFieldBegin("statistics",a.Type.STRUCT,12),this.statistics.write(e),e.writeFieldEnd()),this.encoding_stats!==null&&this.encoding_stats!==void 0){e.writeFieldBegin("encoding_stats",a.Type.LIST,13),e.writeListBegin(a.Type.STRUCT,this.encoding_stats.length);for(var n in this.encoding_stats)this.encoding_stats.hasOwnProperty(n)&&(n=this.encoding_stats[n],n.write(e));e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()};ColumnChunk=g.exports.ColumnChunk=function(e){this.file_path=null,this.file_offset=null,this.meta_data=null,this.offset_index_offset=null,this.offset_index_length=null,this.column_index_offset=null,this.column_index_length=null,e&&(e.file_path!==void 0&&(this.file_path=e.file_path),e.file_offset!==void 0&&(this.file_offset=e.file_offset),e.meta_data!==void 0&&(this.meta_data=e.meta_data),e.offset_index_offset!==void 0&&(this.offset_index_offset=e.offset_index_offset),e.offset_index_length!==void 0&&(this.offset_index_length=e.offset_index_length),e.column_index_offset!==void 0&&(this.column_index_offset=e.column_index_offset),e.column_index_length!==void 0&&(this.column_index_length=e.column_index_length))};ColumnChunk.prototype={};ColumnChunk.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRING?this.file_path=e.readString():e.skip(t);break;case 2:t==a.Type.I64?this.file_offset=e.readI64():e.skip(t);break;case 3:t==a.Type.STRUCT?(this.meta_data=new p.ColumnMetaData,this.meta_data.read(e)):e.skip(t);break;case 4:t==a.Type.I64?this.offset_index_offset=e.readI64():e.skip(t);break;case 5:t==a.Type.I32?this.offset_index_length=e.readI32():e.skip(t);break;case 6:t==a.Type.I64?this.column_index_offset=e.readI64():e.skip(t);break;case 7:t==a.Type.I32?this.column_index_length=e.readI32():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};ColumnChunk.prototype.write=function(e){e.writeStructBegin("ColumnChunk"),this.file_path!==null&&this.file_path!==void 0&&(e.writeFieldBegin("file_path",a.Type.STRING,1),e.writeString(this.file_path),e.writeFieldEnd()),this.file_offset!==null&&this.file_offset!==void 0&&(e.writeFieldBegin("file_offset",a.Type.I64,2),e.writeI64(this.file_offset),e.writeFieldEnd()),this.meta_data!==null&&this.meta_data!==void 0&&(e.writeFieldBegin("meta_data",a.Type.STRUCT,3),this.meta_data.write(e),e.writeFieldEnd()),this.offset_index_offset!==null&&this.offset_index_offset!==void 0&&(e.writeFieldBegin("offset_index_offset",a.Type.I64,4),e.writeI64(this.offset_index_offset),e.writeFieldEnd()),this.offset_index_length!==null&&this.offset_index_length!==void 0&&(e.writeFieldBegin("offset_index_length",a.Type.I32,5),e.writeI32(this.offset_index_length),e.writeFieldEnd()),this.column_index_offset!==null&&this.column_index_offset!==void 0&&(e.writeFieldBegin("column_index_offset",a.Type.I64,6),e.writeI64(this.column_index_offset),e.writeFieldEnd()),this.column_index_length!==null&&this.column_index_length!==void 0&&(e.writeFieldBegin("column_index_length",a.Type.I32,7),e.writeI32(this.column_index_length),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};RowGroup=g.exports.RowGroup=function(e){this.columns=null,this.total_byte_size=null,this.num_rows=null,this.sorting_columns=null,e&&(e.columns!==void 0&&(this.columns=e.columns),e.total_byte_size!==void 0&&(this.total_byte_size=e.total_byte_size),e.num_rows!==void 0&&(this.num_rows=e.num_rows),e.sorting_columns!==void 0&&(this.sorting_columns=e.sorting_columns))};RowGroup.prototype={};RowGroup.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:if(t==a.Type.LIST){var s=0,o;this.columns=[];var l=0;o=e.readListBegin(),l=o.etype,s=o.size;for(var c=0;c<s;++c){var h=null;h=new p.ColumnChunk,h.read(e),this.columns.push(h)}e.readListEnd()}else e.skip(t);break;case 2:t==a.Type.I64?this.total_byte_size=e.readI64():e.skip(t);break;case 3:t==a.Type.I64?this.num_rows=e.readI64():e.skip(t);break;case 4:if(t==a.Type.LIST){var u=0,_;this.sorting_columns=[];var y=0;_=e.readListBegin(),y=_.etype,u=_.size;for(var w=0;w<u;++w){var m=null;m=new p.SortingColumn,m.read(e),this.sorting_columns.push(m)}e.readListEnd()}else e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};RowGroup.prototype.write=function(e){if(e.writeStructBegin("RowGroup"),this.columns!==null&&this.columns!==void 0){e.writeFieldBegin("columns",a.Type.LIST,1),e.writeListBegin(a.Type.STRUCT,this.columns.length);for(var i in this.columns)this.columns.hasOwnProperty(i)&&(i=this.columns[i],i.write(e));e.writeListEnd(),e.writeFieldEnd()}if(this.total_byte_size!==null&&this.total_byte_size!==void 0&&(e.writeFieldBegin("total_byte_size",a.Type.I64,2),e.writeI64(this.total_byte_size),e.writeFieldEnd()),this.num_rows!==null&&this.num_rows!==void 0&&(e.writeFieldBegin("num_rows",a.Type.I64,3),e.writeI64(this.num_rows),e.writeFieldEnd()),this.sorting_columns!==null&&this.sorting_columns!==void 0){e.writeFieldBegin("sorting_columns",a.Type.LIST,4),e.writeListBegin(a.Type.STRUCT,this.sorting_columns.length);for(var r in this.sorting_columns)this.sorting_columns.hasOwnProperty(r)&&(r=this.sorting_columns[r],r.write(e));e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()};TypeDefinedOrder=g.exports.TypeDefinedOrder=function(e){};TypeDefinedOrder.prototype={};TypeDefinedOrder.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;e.skip(t),e.readFieldEnd()}e.readStructEnd()};TypeDefinedOrder.prototype.write=function(e){e.writeStructBegin("TypeDefinedOrder"),e.writeFieldStop(),e.writeStructEnd()};ColumnOrder=g.exports.ColumnOrder=function(e){this.TYPE_ORDER=null,e&&e.TYPE_ORDER!==void 0&&(this.TYPE_ORDER=e.TYPE_ORDER)};ColumnOrder.prototype={};ColumnOrder.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.STRUCT?(this.TYPE_ORDER=new p.TypeDefinedOrder,this.TYPE_ORDER.read(e)):e.skip(t);break;case 0:e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};ColumnOrder.prototype.write=function(e){e.writeStructBegin("ColumnOrder"),this.TYPE_ORDER!==null&&this.TYPE_ORDER!==void 0&&(e.writeFieldBegin("TYPE_ORDER",a.Type.STRUCT,1),this.TYPE_ORDER.write(e),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};PageLocation=g.exports.PageLocation=function(e){this.offset=null,this.compressed_page_size=null,this.first_row_index=null,e&&(e.offset!==void 0&&(this.offset=e.offset),e.compressed_page_size!==void 0&&(this.compressed_page_size=e.compressed_page_size),e.first_row_index!==void 0&&(this.first_row_index=e.first_row_index))};PageLocation.prototype={};PageLocation.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I64?this.offset=e.readI64():e.skip(t);break;case 2:t==a.Type.I32?this.compressed_page_size=e.readI32():e.skip(t);break;case 3:t==a.Type.I64?this.first_row_index=e.readI64():e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};PageLocation.prototype.write=function(e){e.writeStructBegin("PageLocation"),this.offset!==null&&this.offset!==void 0&&(e.writeFieldBegin("offset",a.Type.I64,1),e.writeI64(this.offset),e.writeFieldEnd()),this.compressed_page_size!==null&&this.compressed_page_size!==void 0&&(e.writeFieldBegin("compressed_page_size",a.Type.I32,2),e.writeI32(this.compressed_page_size),e.writeFieldEnd()),this.first_row_index!==null&&this.first_row_index!==void 0&&(e.writeFieldBegin("first_row_index",a.Type.I64,3),e.writeI64(this.first_row_index),e.writeFieldEnd()),e.writeFieldStop(),e.writeStructEnd()};OffsetIndex=g.exports.OffsetIndex=function(e){this.page_locations=null,e&&e.page_locations!==void 0&&(this.page_locations=e.page_locations)};OffsetIndex.prototype={};OffsetIndex.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:if(t==a.Type.LIST){var s=0,o;this.page_locations=[];var l=0;o=e.readListBegin(),l=o.etype,s=o.size;for(var c=0;c<s;++c){var h=null;h=new p.PageLocation,h.read(e),this.page_locations.push(h)}e.readListEnd()}else e.skip(t);break;case 0:e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};OffsetIndex.prototype.write=function(e){if(e.writeStructBegin("OffsetIndex"),this.page_locations!==null&&this.page_locations!==void 0){e.writeFieldBegin("page_locations",a.Type.LIST,1),e.writeListBegin(a.Type.STRUCT,this.page_locations.length);for(var i in this.page_locations)this.page_locations.hasOwnProperty(i)&&(i=this.page_locations[i],i.write(e));e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()};ColumnIndex=g.exports.ColumnIndex=function(e){this.null_pages=null,this.min_values=null,this.max_values=null,this.boundary_order=null,this.null_counts=null,e&&(e.null_pages!==void 0&&(this.null_pages=e.null_pages),e.min_values!==void 0&&(this.min_values=e.min_values),e.max_values!==void 0&&(this.max_values=e.max_values),e.boundary_order!==void 0&&(this.boundary_order=e.boundary_order),e.null_counts!==void 0&&(this.null_counts=e.null_counts))};ColumnIndex.prototype={};ColumnIndex.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:if(t==a.Type.LIST){var s=0,o;this.null_pages=[];var l=0;o=e.readListBegin(),l=o.etype,s=o.size;for(var c=0;c<s;++c){var h=null;h=e.readBool(),this.null_pages.push(h)}e.readListEnd()}else e.skip(t);break;case 2:if(t==a.Type.LIST){var u=0,_;this.min_values=[];var y=0;_=e.readListBegin(),y=_.etype,u=_.size;for(var w=0;w<u;++w){var m=null;m=e.readString(),this.min_values.push(m)}e.readListEnd()}else e.skip(t);break;case 3:if(t==a.Type.LIST){var v=0,S;this.max_values=[];var U=0;S=e.readListBegin(),U=S.etype,v=S.size;for(var k=0;k<v;++k){var O=null;O=e.readString(),this.max_values.push(O)}e.readListEnd()}else e.skip(t);break;case 4:t==a.Type.I32?this.boundary_order=e.readI32():e.skip(t);break;case 5:if(t==a.Type.LIST){var P=0,A;this.null_counts=[];var G=0;A=e.readListBegin(),G=A.etype,P=A.size;for(var M=0;M<P;++M){var b=null;b=e.readI64(),this.null_counts.push(b)}e.readListEnd()}else e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};ColumnIndex.prototype.write=function(e){if(e.writeStructBegin("ColumnIndex"),this.null_pages!==null&&this.null_pages!==void 0){e.writeFieldBegin("null_pages",a.Type.LIST,1),e.writeListBegin(a.Type.BOOL,this.null_pages.length);for(var i in this.null_pages)this.null_pages.hasOwnProperty(i)&&(i=this.null_pages[i],e.writeBool(i));e.writeListEnd(),e.writeFieldEnd()}if(this.min_values!==null&&this.min_values!==void 0){e.writeFieldBegin("min_values",a.Type.LIST,2),e.writeListBegin(a.Type.STRING,this.min_values.length);for(var r in this.min_values)this.min_values.hasOwnProperty(r)&&(r=this.min_values[r],e.writeString(r));e.writeListEnd(),e.writeFieldEnd()}if(this.max_values!==null&&this.max_values!==void 0){e.writeFieldBegin("max_values",a.Type.LIST,3),e.writeListBegin(a.Type.STRING,this.max_values.length);for(var t in this.max_values)this.max_values.hasOwnProperty(t)&&(t=this.max_values[t],e.writeString(t));e.writeListEnd(),e.writeFieldEnd()}if(this.boundary_order!==null&&this.boundary_order!==void 0&&(e.writeFieldBegin("boundary_order",a.Type.I32,4),e.writeI32(this.boundary_order),e.writeFieldEnd()),this.null_counts!==null&&this.null_counts!==void 0){e.writeFieldBegin("null_counts",a.Type.LIST,5),e.writeListBegin(a.Type.I64,this.null_counts.length);for(var n in this.null_counts)this.null_counts.hasOwnProperty(n)&&(n=this.null_counts[n],e.writeI64(n));e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()};FileMetaData=g.exports.FileMetaData=function(e){this.version=null,this.schema=null,this.num_rows=null,this.row_groups=null,this.key_value_metadata=null,this.created_by=null,this.column_orders=null,e&&(e.version!==void 0&&(this.version=e.version),e.schema!==void 0&&(this.schema=e.schema),e.num_rows!==void 0&&(this.num_rows=e.num_rows),e.row_groups!==void 0&&(this.row_groups=e.row_groups),e.key_value_metadata!==void 0&&(this.key_value_metadata=e.key_value_metadata),e.created_by!==void 0&&(this.created_by=e.created_by),e.column_orders!==void 0&&(this.column_orders=e.column_orders))};FileMetaData.prototype={};FileMetaData.prototype.read=function(e){for(e.readStructBegin();;){var i=e.readFieldBegin(),r=i.fname,t=i.ftype,n=i.fid;if(t==a.Type.STOP)break;switch(n){case 1:t==a.Type.I32?this.version=e.readI32():e.skip(t);break;case 2:if(t==a.Type.LIST){var s=0,o;this.schema=[];var l=0;o=e.readListBegin(),l=o.etype,s=o.size;for(var c=0;c<s;++c){var h=null;h=new p.SchemaElement,h.read(e),this.schema.push(h)}e.readListEnd()}else e.skip(t);break;case 3:t==a.Type.I64?this.num_rows=e.readI64():e.skip(t);break;case 4:if(t==a.Type.LIST){var u=0,_;this.row_groups=[];var y=0;_=e.readListBegin(),y=_.etype,u=_.size;for(var w=0;w<u;++w){var m=null;m=new p.RowGroup,m.read(e),this.row_groups.push(m)}e.readListEnd()}else e.skip(t);break;case 5:if(t==a.Type.LIST){var v=0,S;this.key_value_metadata=[];var U=0;S=e.readListBegin(),U=S.etype,v=S.size;for(var k=0;k<v;++k){var O=null;O=new p.KeyValue,O.read(e),this.key_value_metadata.push(O)}e.readListEnd()}else e.skip(t);break;case 6:t==a.Type.STRING?this.created_by=e.readString():e.skip(t);break;case 7:if(t==a.Type.LIST){var P=0,A;this.column_orders=[];var G=0;A=e.readListBegin(),G=A.etype,P=A.size;for(var M=0;M<P;++M){var b=null;b=new p.ColumnOrder,b.read(e),this.column_orders.push(b)}e.readListEnd()}else e.skip(t);break;default:e.skip(t)}e.readFieldEnd()}e.readStructEnd()};FileMetaData.prototype.write=function(e){if(e.writeStructBegin("FileMetaData"),this.version!==null&&this.version!==void 0&&(e.writeFieldBegin("version",a.Type.I32,1),e.writeI32(this.version),e.writeFieldEnd()),this.schema!==null&&this.schema!==void 0){e.writeFieldBegin("schema",a.Type.LIST,2),e.writeListBegin(a.Type.STRUCT,this.schema.length);for(var i in this.schema)this.schema.hasOwnProperty(i)&&(i=this.schema[i],i.write(e));e.writeListEnd(),e.writeFieldEnd()}if(this.num_rows!==null&&this.num_rows!==void 0&&(e.writeFieldBegin("num_rows",a.Type.I64,3),e.writeI64(this.num_rows),e.writeFieldEnd()),this.row_groups!==null&&this.row_groups!==void 0){e.writeFieldBegin("row_groups",a.Type.LIST,4),e.writeListBegin(a.Type.STRUCT,this.row_groups.length);for(var r in this.row_groups)this.row_groups.hasOwnProperty(r)&&(r=this.row_groups[r],r.write(e));e.writeListEnd(),e.writeFieldEnd()}if(this.key_value_metadata!==null&&this.key_value_metadata!==void 0){e.writeFieldBegin("key_value_metadata",a.Type.LIST,5),e.writeListBegin(a.Type.STRUCT,this.key_value_metadata.length);for(var t in this.key_value_metadata)this.key_value_metadata.hasOwnProperty(t)&&(t=this.key_value_metadata[t],t.write(e));e.writeListEnd(),e.writeFieldEnd()}if(this.created_by!==null&&this.created_by!==void 0&&(e.writeFieldBegin("created_by",a.Type.STRING,6),e.writeString(this.created_by),e.writeFieldEnd()),this.column_orders!==null&&this.column_orders!==void 0){e.writeFieldBegin("column_orders",a.Type.LIST,7),e.writeListBegin(a.Type.STRUCT,this.column_orders.length);for(var n in this.column_orders)this.column_orders.hasOwnProperty(n)&&(n=this.column_orders[n],n.write(e));e.writeListEnd(),e.writeFieldEnd()}e.writeFieldStop(),e.writeStructEnd()}});var re=T((Xo,tt)=>{"use strict";var Ki=d(()=>{throw new Error("Not Supported in Lite version")},"NOT_SUPPORTED"),$={BOOLEAN:{primitiveType:"BOOLEAN",toPrimitive:hn,fromPrimitive:un},INT32:{primitiveType:"INT32",toPrimitive:Zi},INT64:{primitiveType:"INT64",toPrimitive:Qi},INT96:{primitiveType:"INT96",toPrimitive:In},FLOAT:{primitiveType:"FLOAT",toPrimitive:_n},DOUBLE:{primitiveType:"DOUBLE",toPrimitive:Tn},BYTE_ARRAY:{primitiveType:"BYTE_ARRAY",toPrimitive:Xi},FIXED_LEN_BYTE_ARRAY:{primitiveType:"FIXED_LEN_BYTE_ARRAY",toPrimitive:Xi},UTF8:{primitiveType:"BYTE_ARRAY",originalType:"UTF8",toPrimitive:$i,fromPrimitive:et},ENUM:{primitiveType:"BYTE_ARRAY",originalType:"UTF8",toPrimitive:$i,fromPrimitive:et},TIME_MILLIS:{primitiveType:"INT32",originalType:"TIME_MILLIS",toPrimitive:Bn},TIME_MICROS:{primitiveType:"INT64",originalType:"TIME_MICROS",toPrimitive:Fn},DATE:{primitiveType:"INT32",originalType:"DATE",toPrimitive:xn,fromPrimitive:Ln},TIMESTAMP_MILLIS:{primitiveType:"INT64",originalType:"TIMESTAMP_MILLIS",toPrimitive:Pn,fromPrimitive:bn},TIMESTAMP_MICROS:{primitiveType:"INT64",originalType:"TIMESTAMP_MICROS",toPrimitive:On,fromPrimitive:Nn},UINT_8:{primitiveType:"INT32",originalType:"UINT_8",toPrimitive:wn},UINT_16:{primitiveType:"INT32",originalType:"UINT_16",toPrimitive:mn},UINT_32:{primitiveType:"INT32",originalType:"UINT_32",toPrimitive:gn},UINT_64:{primitiveType:"INT64",originalType:"UINT_64",toPrimitive:vn},INT_8:{primitiveType:"INT32",originalType:"INT_8",toPrimitive:pn},INT_16:{primitiveType:"INT32",originalType:"INT_16",toPrimitive:yn},INT_32:{primitiveType:"INT32",originalType:"INT_32",toPrimitive:Zi},INT_64:{primitiveType:"INT64",originalType:"INT_64",toPrimitive:Qi},JSON:{primitiveType:"BYTE_ARRAY",originalType:"JSON",toPrimitive:En,fromPrimitive:Sn},BSON:{primitiveType:"BYTE_ARRAY",originalType:"BSON",toPrimitive:Ki,fromPrimitive:Ki},INTERVAL:{primitiveType:"FIXED_LEN_BYTE_ARRAY",originalType:"INTERVAL",typeLength:12,toPrimitive:kn,fromPrimitive:An}};function fn(e,i){if(!(e in $))throw"invalid type: "+e;return $[e].toPrimitive(i)}d(fn,"toPrimitive");function cn(e,i){if(!(e in $))throw"invalid type: "+e;return"fromPrimitive"in $[e]?$[e].fromPrimitive(i):i}d(cn,"fromPrimitive");function hn(e){return!!e}d(hn,"toPrimitive_BOOLEAN");function un(e){return!!e}d(un,"fromPrimitive_BOOLEAN");function _n(e){let i=parseFloat(e);if(isNaN(i))throw"invalid value for FLOAT: "+e;return i}d(_n,"toPrimitive_FLOAT");function Tn(e){let i=parseFloat(e);if(isNaN(i))throw"invalid value for DOUBLE: "+e;return i}d(Tn,"toPrimitive_DOUBLE");function pn(e){let i=parseInt(e,10);if(i<-128||i>127||isNaN(i))throw"invalid value for INT8: "+e;return i}d(pn,"toPrimitive_INT8");function wn(e){let i=parseInt(e,10);if(i<0||i>255||isNaN(i))throw"invalid value for UINT8: "+e;return i}d(wn,"toPrimitive_UINT8");function yn(e){let i=parseInt(e,10);if(i<-32768||i>32767||isNaN(i))throw"invalid value for INT16: "+e;return i}d(yn,"toPrimitive_INT16");function mn(e){let i=parseInt(e,10);if(i<0||i>65535||isNaN(i))throw"invalid value for UINT16: "+e;return i}d(mn,"toPrimitive_UINT16");function Zi(e){let i=parseInt(e,10);if(i<-2147483648||i>2147483647||isNaN(i))throw"invalid value for INT32: "+e;return i}d(Zi,"toPrimitive_INT32");function gn(e){let i=parseInt(e,10);if(i<0||i>0xffffffffffff||isNaN(i))throw"invalid value for UINT32: "+e;return i}d(gn,"toPrimitive_UINT32");function Qi(e){let i=parseInt(e,10);if(isNaN(i))throw"invalid value for INT64: "+e;return i}d(Qi,"toPrimitive_INT64");function vn(e){let i=parseInt(e,10);if(i<0||isNaN(i))throw"invalid value for UINT64: "+e;return i}d(vn,"toPrimitive_UINT64");function In(e){let i=parseInt(e,10);if(isNaN(i))throw"invalid value for INT96: "+e;return i}d(In,"toPrimitive_INT96");function Xi(e){return Buffer.from(e)}d(Xi,"toPrimitive_BYTE_ARRAY");function $i(e){return Buffer.from(e,"utf8")}d($i,"toPrimitive_UTF8");function et(e){return e!=null?e.toString():e}d(et,"fromPrimitive_UTF8");function En(e){return Buffer.from(JSON.stringify(e))}d(En,"toPrimitive_JSON");function Sn(e){return JSON.parse(e)}d(Sn,"fromPrimitive_JSON");function Bn(e){let i=parseInt(e,10);if(i<0||i>18446744073709552e3||isNaN(i))throw"invalid value for TIME_MILLIS: "+e;return i}d(Bn,"toPrimitive_TIME_MILLIS");function Fn(e){let i=parseInt(e,10);if(i<0||isNaN(i))throw"invalid value for TIME_MICROS: "+e;return i}d(Fn,"toPrimitive_TIME_MICROS");var it=864e5;function xn(e){if(e instanceof Date)return e.getTime()/it;{let i=parseInt(e,10);if(i<0||isNaN(i))throw"invalid value for DATE: "+e;return i}}d(xn,"toPrimitive_DATE");function Ln(e){return new Date(+e*it)}d(Ln,"fromPrimitive_DATE");function Pn(e){if(e instanceof Date)return e.getTime();{let i=parseInt(e,10);if(i<0||isNaN(i))throw"invalid value for TIMESTAMP_MILLIS: "+e;return i}}d(Pn,"toPrimitive_TIMESTAMP_MILLIS");function bn(e){return new Date(+e)}d(bn,"fromPrimitive_TIMESTAMP_MILLIS");function On(e){if(e instanceof Date)return e.getTime()*1e3;{let i=parseInt(e,10);if(i<0||isNaN(i))throw"invalid value for TIMESTAMP_MICROS: "+e;return i}}d(On,"toPrimitive_TIMESTAMP_MICROS");function Nn(e){return new Date(+e/1e3)}d(Nn,"fromPrimitive_TIMESTAMP_MICROS");function kn(e){if(!e.months||!e.days||!e.milliseconds)throw"value for INTERVAL must be object { months: ..., days: ..., milliseconds: ... }";let i=Buffer.alloc(12);return i.writeUInt32LE(e.months,0),i.writeUInt32LE(e.days,4),i.writeUInt32LE(e.milliseconds,8),i}d(kn,"toPrimitive_INTERVAL");function An(e){let i=Buffer.from(e),r=i.readUInt32LE(0),t=i.readUInt32LE(4),n=i.readUInt32LE(8);return{months:r,days:t,milliseconds:n}}d(An,"fromPrimitive_INTERVAL");tt.exports={PARQUET_LOGICAL_TYPES:$,toPrimitive:fn,fromPrimitive:cn}});var st=T((ed,nt)=>{var V={},ne=4294967295,Rn=9007199254740991;function Le(e){return e=~e,e<0&&(e=(e&2147483647)+2147483648),e}d(Le,"onesComplement");function Pe(e){console.assert(e>-1&&e<=Rn,"number out of range"),console.assert(Math.floor(e)===e,"number must be an integer");var i=0,r=e&4294967295,t=r<0?(e&2147483647)+2147483648:r;return e>ne&&(i=(e-t)/(ne+1)),[i,t]}d(Pe,"uintHighLow");function rt(e){if(e>-1)return Pe(e);var i=Pe(-e),r=Le(i[0]),t=Le(i[1]);return t===ne?(r+=1,t=0):t+=1,[r,t]}d(rt,"intHighLow");function be(e,i,r){return r&&e&2147483648?(e=Le(e),i=Le(i),console.assert(e<2097152,"number too small"),-(e*(ne+1)+i+1)):(console.assert(e<2097152,"number too large"),e*(ne+1)+i)}d(be,"toDouble");V.readInt64BE=function(e,i){i=i||0;var r=e.readUInt32BE(i),t=e.readUInt32BE(i+4);return be(r,t,!0)};V.readInt64LE=function(e,i){i=i||0;var r=e.readUInt32LE(i),t=e.readUInt32LE(i+4);return be(t,r,!0)};V.readUInt64BE=function(e,i){i=i||0;var r=e.readUInt32BE(i),t=e.readUInt32BE(i+4);return be(r,t,!1)};V.readUInt64LE=function(e,i){i=i||0;var r=e.readUInt32LE(i),t=e.readUInt32LE(i+4);return be(t,r,!1)};V.writeInt64BE=function(e,i,r){r=r||0;var t=rt(e);i.writeUInt32BE(t[0],r),i.writeUInt32BE(t[1],r+4)};V.writeInt64LE=function(e,i,r){r=r||0;var t=rt(e);i.writeUInt32LE(t[1],r),i.writeUInt32LE(t[0],r+4)};V.writeUInt64BE=function(e,i,r){r=r||0;var t=Pe(e);i.writeUInt32BE(t[0],r),i.writeUInt32BE(t[1],r+4)};V.writeUInt64LE=function(e,i,r){r=r||0;var t=Pe(e);i.writeUInt32LE(t[1],r),i.writeUInt32LE(t[0],r+4)};nt.exports=V});var at=T(ri=>{"use strict";var se=st();function Cn(e){let i=Buffer.alloc(Math.ceil(e.length/8));i.fill(0);for(let r=0;r<e.length;++r)e[r]&&(i[Math.floor(r/8)]|=1<<r%8);return i}d(Cn,"encodeValues_BOOLEAN");function Mn(e,i){let r=[];for(let t=0;t<i;++t){let n=e.buffer[e.offset+Math.floor(t/8)];r.push((n&1<<t%8)>0)}return e.offset+=Math.ceil(i/8),r}d(Mn,"decodeValues_BOOLEAN");function Un(e){let i=Buffer.alloc(4*e.length);for(let r=0;r<e.length;r++)i.writeInt32LE(e[r],r*4);return i}d(Un,"encodeValues_INT32");function Dn(e,i){let r=[];for(let t=0;t<i;++t)r.push(e.buffer.readInt32LE(e.offset)),e.offset+=4;return r}d(Dn,"decodeValues_INT32");function zn(e){let i=Buffer.alloc(8*e.length);for(let r=0;r<e.length;r++)se.writeInt64LE(e[r],i,r*8);return i}d(zn,"encodeValues_INT64");function qn(e,i){let r=[];for(let t=0;t<i;++t)r.push(se.readInt64LE(e.buffer,e.offset)),e.offset+=8;return r}d(qn,"decodeValues_INT64");function Vn(e){let i=Buffer.alloc(12*e.length);for(let r=0;r<e.length;r++)e[r]>=0?(se.writeInt64LE(e[r],i,r*12),i.writeUInt32LE(0,r*12+8)):(se.writeInt64LE(~-e[r]+1,i,r*12),i.writeUInt32LE(4294967295,r*12+8));return i}d(Vn,"encodeValues_INT96");function Gn(e,i){let r=[];for(let t=0;t<i;++t){let n=se.readInt64LE(e.buffer,e.offset);e.buffer.readUInt32LE(e.offset+8)===4294967295?r.push(~-n+1):r.push(n),e.offset+=12}return r}d(Gn,"decodeValues_INT96");function Yn(e){let i=Buffer.alloc(4*e.length);for(let r=0;r<e.length;r++)i.writeFloatLE(e[r],r*4);return i}d(Yn,"encodeValues_FLOAT");function Wn(e,i){let r=[];for(let t=0;t<i;++t)r.push(e.buffer.readFloatLE(e.offset)),e.offset+=4;return r}d(Wn,"decodeValues_FLOAT");function jn(e){let i=Buffer.alloc(8*e.length);for(let r=0;r<e.length;r++)i.writeDoubleLE(e[r],r*8);return i}d(jn,"encodeValues_DOUBLE");function Hn(e,i){let r=[];for(let t=0;t<i;++t)r.push(e.buffer.readDoubleLE(e.offset)),e.offset+=8;return r}d(Hn,"decodeValues_DOUBLE");function Jn(e){let i=0;for(let n=0;n<e.length;n++)e[n]=Buffer.from(e[n]),i+=4+e[n].length;let r=Buffer.alloc(i),t=0;for(let n=0;n<e.length;n++)r.writeUInt32LE(e[n].length,t),e[n].copy(r,t+4),t+=4+e[n].length;return r}d(Jn,"encodeValues_BYTE_ARRAY");function Kn(e,i){let r=[];for(let t=0;t<i;++t){let n=e.buffer.readUInt32LE(e.offset);e.offset+=4,r.push(e.buffer.slice(e.offset,e.offset+n)),e.offset+=n}return r}d(Kn,"decodeValues_BYTE_ARRAY");function Zn(e,i){if(!i.typeLength)throw"missing option: typeLength (required for FIXED_LEN_BYTE_ARRAY)";let r=0;for(let t=0;t<e.length;t++)if(e[t]=Buffer.from(e[t]),e[t].length!==i.typeLength)throw"invalid value for FIXED_LEN_BYTE_ARRAY: "+e[t];return Buffer.concat(e)}d(Zn,"encodeValues_FIXED_LEN_BYTE_ARRAY");function Qn(e,i,r){let t=[];if(!r.typeLength)throw"missing option: typeLength (required for FIXED_LEN_BYTE_ARRAY)";for(let n=0;n<i;++n)t.push(e.buffer.slice(e.offset,e.offset+r.typeLength)),e.offset+=r.typeLength;return t}d(Qn,"decodeValues_FIXED_LEN_BYTE_ARRAY");ri.encodeValues=function(e,i,r){switch(e){case"BOOLEAN":return Cn(i);case"INT32":return Un(i);case"INT64":return zn(i);case"INT96":return Vn(i);case"FLOAT":return Yn(i);case"DOUBLE":return jn(i);case"BYTE_ARRAY":return Jn(i);case"FIXED_LEN_BYTE_ARRAY":return Zn(i,r);default:throw"unsupported type: "+e}};ri.decodeValues=function(e,i,r,t){switch(e){case"BOOLEAN":return Mn(i,r);case"INT32":return Dn(i,r);case"INT64":return qn(i,r);case"INT96":return Gn(i,r);case"FLOAT":return Wn(i,r);case"DOUBLE":return Hn(i,r);case"BYTE_ARRAY":return Kn(i,r);case"FIXED_LEN_BYTE_ARRAY":return Qn(i,r,t);default:throw"unsupported type: "+e}}});var ft=T((nd,lt)=>{lt.exports=dt;var ot=128,Xn=127,$n=~Xn,es=Math.pow(2,31);function dt(e,i,r){i=i||[],r=r||0;for(var t=r;e>=es;)i[r++]=e&255|ot,e/=128;for(;e&$n;)i[r++]=e&255|ot,e>>>=7;return i[r]=e|0,dt.bytes=r-t+1,i}d(dt,"encode")});var ut=T((ad,ht)=>{ht.exports=ni;var is=128,ct=127;function ni(e,t){var r=0,t=t||0,n=0,s=t,o,l=e.length;do{if(s>=l)throw ni.bytes=0,new RangeError("Could not decode varint");o=e[s++],r+=n<28?(o&ct)<<n:(o&ct)*Math.pow(2,n),n+=7}while(o>=is);return ni.bytes=s-t,r}d(ni,"read")});var Tt=T((dd,_t)=>{var ts=Math.pow(2,7),rs=Math.pow(2,14),ns=Math.pow(2,21),ss=Math.pow(2,28),as=Math.pow(2,35),os=Math.pow(2,42),ds=Math.pow(2,49),ls=Math.pow(2,56),fs=Math.pow(2,63);_t.exports=function(e){return e<ts?1:e<rs?2:e<ns?3:e<ss?4:e<as?5:e<os?6:e<ds?7:e<ls?8:e<fs?9:10}});var wt=T((ld,pt)=>{pt.exports={encode:ft(),decode:ut(),encodingLength:Tt()}});var ai=T(si=>{var Oe=wt();function yt(e,i){for(let t=0;t<e.length%8;t++)e.push(0);let r=Buffer.alloc(Math.ceil(i.bitWidth*(e.length/8)));for(let t=0;t<i.bitWidth*e.length;++t)(e[Math.floor(t/i.bitWidth)]&1<<t%i.bitWidth)>0&&(r[Math.floor(t/8)]|=1<<t%8);return Buffer.concat([Buffer.from(Oe.encode(e.length/8<<1|1)),r])}d(yt,"encodeRunBitpacked");function mt(e,i,r){let t=Buffer.alloc(Math.ceil(r.bitWidth/8));for(let n=0;n<t.length;++n)t.writeUInt8(e&255,n),e>>8;return Buffer.concat([Buffer.from(Oe.encode(i<<1)),t])}d(mt,"encodeRunRepeated");si.encodeValues=function(e,i,r){if(!("bitWidth"in r))throw"bitWidth is required";switch(e){case"BOOLEAN":case"INT32":case"INT64":i=i.map(l=>parseInt(l,10));break;default:throw"unsupported type: "+e}let t=Buffer.alloc(0),n=[],s=0;for(let l=0;l<i.length;l++)s===0&&n.length%8===0&&i[l]===i[l+1]?(n.length&&(t=Buffer.concat([t,yt(n,r)]),n=[]),s=1):s>0&&i[l]===i[l-1]?s+=1:(s&&(t=Buffer.concat([t,mt(i[l-1],s,r)]),s=0),n.push(i[l]));if(s?t=Buffer.concat([t,mt(i[i.length-1],s,r)]):n.length&&(t=Buffer.concat([t,yt(n,r)])),r.disableEnvelope)return t;let o=Buffer.alloc(t.length+4);return o.writeUInt32LE(t.length),t.copy(o,4),o};function cs(e,i,r){if(i%8!==0)throw"must be a multiple of 8";let t=new Array(i).fill(0);for(let n=0;n<r.bitWidth*i;++n)e.buffer[e.offset+Math.floor(n/8)]&1<<n%8&&(t[Math.floor(n/r.bitWidth)]|=1<<n%r.bitWidth);return e.offset+=r.bitWidth*(i/8),t}d(cs,"decodeRunBitpacked");function hs(e,i,r){let t=0;for(let n=0;n<Math.ceil(r.bitWidth/8);++n)t<<8,t+=e.buffer[e.offset],e.offset+=1;return new Array(i).fill(t)}d(hs,"decodeRunRepeated");si.decodeValues=function(e,i,r,t){if(!("bitWidth"in t))throw"bitWidth is required";t.disableEnvelope||(i.offset+=4);let n=[],s;for(;n.length<r;){let o=Oe.decode(i.buffer,i.offset);i.offset+=Oe.encodingLength(o),o&1?s=cs(i,(o>>1)*8,t):s=hs(i,o>>1,t);for(let l=0;l<s.length;l++)n.push(s[l])}if(n=n.slice(0,r),n.length!==r)throw"invalid RLE encoding";return n}});var vt=T(gt=>{var us=ai();gt.decodeValues=function(e,i,r,t){return t.bitWidth=i.buffer.slice(i.offset,i.offset+1).readInt8(),i.offset+=1,us.decodeValues(e,i,r,Object.assign({},t,{disableEnvelope:!0}))}});var ke=T((ud,Ne)=>{Ne.exports.PLAIN=at();Ne.exports.RLE=ai();Ne.exports.PLAIN_DICTIONARY=vt()});var Et=T(It=>{"use strict";var _s=[0,255,65535,16777215,4294967295];function Ts(e,i,r,t,n){var s;for(s=0;s<n;s++)r[t+s]=e[i+s]}d(Ts,"copyBytes");function ps(e,i,r,t){var n;for(n=0;n<t;n++)e[i+n]=e[i-r+n]}d(ps,"selfCopyBytes");function oi(e){this.array=e,this.pos=0}d(oi,"SnappyDecompressor");oi.prototype.readUncompressedLength=function(){for(var e=0,i=0,r,t;i<32&&this.pos<this.array.length;){if(r=this.array[this.pos],this.pos+=1,t=r&127,t<<i>>>i!==t)return-1;if(e|=t<<i,r<128)return e;i+=7}return-1};oi.prototype.uncompressToBuffer=function(e){for(var i=this.array,r=i.length,t=this.pos,n=0,s,o,l,c;t<i.length;)if(s=i[t],t+=1,s&3){switch(s&3){case 1:o=(s>>>2&7)+4,c=i[t]+(s>>>5<<8),t+=1;break;case 2:if(t+1>=r)return!1;o=(s>>>2)+1,c=i[t]+(i[t+1]<<8),t+=2;break;case 3:if(t+3>=r)return!1;o=(s>>>2)+1,c=i[t]+(i[t+1]<<8)+(i[t+2]<<16)+(i[t+3]<<24),t+=4;break;default:break}if(c===0||c>n)return!1;ps(e,n,c,o),n+=o}else{if(o=(s>>>2)+1,o>60){if(t+3>=r)return!1;l=o-60,o=i[t]+(i[t+1]<<8)+(i[t+2]<<16)+(i[t+3]<<24),o=(o&_s[l])+1,t+=l}if(t+o>r)return!1;Ts(i,t,e,n,o),t+=o,n+=o}return!0};It.SnappyDecompressor=oi});var Lt=T(xt=>{"use strict";var ws=16,ys=1<<ws,Ft=14,di=new Array(Ft+1);function ae(e,i){return e*506832829>>>i}d(ae,"hashFunc");function oe(e,i){return e[i]+(e[i+1]<<8)+(e[i+2]<<16)+(e[i+3]<<24)}d(oe,"load32");function St(e,i,r){return e[i]===e[r]&&e[i+1]===e[r+1]&&e[i+2]===e[r+2]&&e[i+3]===e[r+3]}d(St,"equals32");function ms(e,i,r,t,n){var s;for(s=0;s<n;s++)r[t+s]=e[i+s]}d(ms,"copyBytes");function Bt(e,i,r,t,n){return r<=60?(t[n]=r-1<<2,n+=1):r<256?(t[n]=240,t[n+1]=r-1,n+=2):(t[n]=244,t[n+1]=r-1&255,t[n+2]=r-1>>>8,n+=3),ms(e,i,t,n,r),n+r}d(Bt,"emitLiteral");function li(e,i,r,t){return t<12&&r<2048?(e[i]=1+(t-4<<2)+(r>>>8<<5),e[i+1]=r&255,i+2):(e[i]=2+(t-1<<2),e[i+1]=r&255,e[i+2]=r>>>8,i+3)}d(li,"emitCopyLessThan64");function gs(e,i,r,t){for(;t>=68;)i=li(e,i,r,64),t-=64;return t>64&&(i=li(e,i,r,60),t-=60),li(e,i,r,t)}d(gs,"emitCopy");function vs(e,i,r,t,n){for(var s=1;1<<s<=r&&s<=Ft;)s+=1;s-=1;var o=32-s;typeof di[s]>"u"&&(di[s]=new Uint16Array(1<<s));var l=di[s],c;for(c=0;c<l.length;c++)l[c]=0;var h=i+r,u,_=i,y=i,w,m,v,S,U,k,O,P,A,G,M,b=!0,ki=15;if(r>=ki)for(u=h-ki,i+=1,m=ae(oe(e,i),o);b;){U=32,v=i;do{if(i=v,w=m,k=U>>>5,U+=1,v=i+k,i>u){b=!1;break}m=ae(oe(e,v),o),S=_+l[w],l[w]=i-_}while(!St(e,i,S));if(!b)break;n=Bt(e,y,i-y,t,n);do{for(O=i,P=4;i+P<h&&e[i+P]===e[S+P];)P+=1;if(i+=P,A=O-S,n=gs(t,n,A,P),y=i,i>=u){b=!1;break}G=ae(oe(e,i-1),o),l[G]=i-1-_,M=ae(oe(e,i),o),S=_+l[M],l[M]=i-_}while(St(e,i,S));if(!b)break;i+=1,m=ae(oe(e,i),o)}return y<h&&(n=Bt(e,y,h-y,t,n)),n}d(vs,"compressFragment");function Is(e,i,r){do i[r]=e&127,e=e>>>7,e>0&&(i[r]+=128),r+=1;while(e>0);return r}d(Is,"putVarint");function fi(e){this.array=e}d(fi,"SnappyCompressor");fi.prototype.maxCompressedLength=function(){var e=this.array.length;return 32+e+Math.floor(e/6)};fi.prototype.compressToBuffer=function(e){var i=this.array,r=i.length,t=0,n=0,s;for(n=Is(r,e,n);t<r;)s=Math.min(r-t,ys),n=vs(i,t,s,e,n),t+=s;return n};xt.SnappyCompressor=fi});var Nt=T(ci=>{"use strict";function Pt(){return typeof process=="object"&&typeof process.versions=="object"&&typeof process.versions.node<"u"}d(Pt,"isNode");function Ae(e){return e instanceof Uint8Array&&(!Pt()||!Buffer.isBuffer(e))}d(Ae,"isUint8Array");function Re(e){return e instanceof ArrayBuffer}d(Re,"isArrayBuffer");function bt(e){return Pt()?Buffer.isBuffer(e):!1}d(bt,"isBuffer");var Es=Et().SnappyDecompressor,Ss=Lt().SnappyCompressor,Ot="Argument compressed must be type of ArrayBuffer, Buffer, or Uint8Array";function Bs(e){if(!Ae(e)&&!Re(e)&&!bt(e))throw new TypeError(Ot);var i=!1,r=!1;Ae(e)?i=!0:Re(e)&&(r=!0,e=new Uint8Array(e));var t=new Es(e),n=t.readUncompressedLength();if(n===-1)throw new Error("Invalid Snappy bitstream");var s,o;if(i){if(s=new Uint8Array(n),!t.uncompressToBuffer(s))throw new Error("Invalid Snappy bitstream")}else if(r){if(s=new ArrayBuffer(n),o=new Uint8Array(s),!t.uncompressToBuffer(o))throw new Error("Invalid Snappy bitstream")}else if(s=Buffer.alloc(n),!t.uncompressToBuffer(s))throw new Error("Invalid Snappy bitstream");return s}d(Bs,"uncompress");function Fs(e){if(!Ae(e)&&!Re(e)&&!bt(e))throw new TypeError(Ot);var i=!1,r=!1;Ae(e)?i=!0:Re(e)&&(r=!0,e=new Uint8Array(e));var t=new Ss(e),n=t.maxCompressedLength(),s,o,l;if(i?(s=new Uint8Array(n),l=t.compressToBuffer(s)):r?(s=new ArrayBuffer(n),o=new Uint8Array(s),l=t.compressToBuffer(o)):(s=Buffer.alloc(n),l=t.compressToBuffer(s)),!s.slice){var c=new Uint8Array(Array.prototype.slice.call(s,0,l));if(i)return c;if(r)return c.buffer;throw new Error("Not implemented")}return s.slice(0,l)}d(Fs,"compress");ci.uncompress=Bs;ci.compress=Fs});var Me=T((gd,Rt)=>{"use strict";var kt=require("zlib"),At=Nt(),Ce=d(()=>{throw new Error("Not Supported in Lite version")},"NOT_SUPPORTED"),de={UNCOMPRESSED:{deflate:Ls,inflate:Ns},GZIP:{deflate:Ps,inflate:ks},SNAPPY:{deflate:bs,inflate:As},LZO:{deflate:Ce,inflate:Ce},BROTLI:{deflate:Ce,inflate:Ce}};function xs(e,i){if(!(e in de))throw"invalid compression method: "+e;return de[e].deflate(i)}d(xs,"deflate");function Ls(e){return e}d(Ls,"deflate_identity");function Ps(e){return kt.gzipSync(e)}d(Ps,"deflate_gzip");function bs(e){return At.compress(e)}d(bs,"deflate_snappy");function Os(e,i){if(!(e in de))throw"invalid compression method: "+e;return de[e].inflate(i)}d(Os,"inflate");function Ns(e){return e}d(Ns,"inflate_identity");function ks(e){return kt.gunzipSync(e)}d(ks,"inflate_gzip");function As(e){return At.uncompress(e)}d(As,"inflate_snappy");Rt.exports={PARQUET_COMPRESSION_METHODS:de,deflate:xs,inflate:Os}});var ee=T(R=>{"use strict";var fe=require("fs"),le=ti(),Ct=X(),_i=class _i extends le.TFramedTransport{readString(i){this.ensureAvailable(i);var r=this.inBuf.slice(this.readPos,this.readPos+i),t=this.inBuf.toString("utf8",this.readPos,this.readPos+i);return this.readPos+=i,Buffer.from(t).equals(r)?t:r}};d(_i,"fixedTFramedTransport");var hi=_i,Mt=Ct.PageLocation.prototype,ce=Ct.PageLocation.prototype=[];ce.write=Mt.write;ce.read=Mt.read;var ui=d(e=>({get:function(){return this[e]},set:function(i){return this[e]=i}}),"getterSetter");Object.defineProperty(ce,"offset",ui(0));Object.defineProperty(ce,"compressed_page_size",ui(1));Object.defineProperty(ce,"first_row_index",ui(2));R.force32=function(){let e=le.TCompactProtocol.prototype;e.zigzagToI64=e.zigzagToI32,e.readVarint64=e.readVarint32=function(){let i=0,r=0,t;for(;t=this.trans.readByte(),i=i|(t&127)<<r,r+=7,!!(t&128););return i}};R.serializeThrift=function(e){let i=[],r=new le.TBufferedTransport(null,function(n){i.push(n)}),t=new le.TCompactProtocol(r);return e.write(t),r.flush(),Buffer.concat(i)};R.decodeThrift=function(e,i,r){r||(r=0);var t=new hi(i);t.readPos=r;var n=new le.TCompactProtocol(t);return e.read(n),t.readPos-r};R.getBitWidth=function(e){return e===0?0:Math.ceil(Math.log2(e+1))};R.getThriftEnum=function(e,i){for(let r in e)if(e[r]===i)return r;throw"Invalid ENUM value"};R.fopen=function(e){return new Promise((i,r)=>{fe.open(e,"r",(t,n)=>{t?r(t):i(n)})})};R.fstat=function(e){return new Promise((i,r)=>{fe.stat(e,(t,n)=>{t?r(t):i(n)})})};R.fread=function(e,i,r){let t=Buffer.alloc(r);return new Promise((n,s)=>{fe.read(e,t,0,r,i,(o,l,c)=>{o||l!=r?s(o||Error("read failed")):n(c)})})};R.fclose=function(e){return new Promise((i,r)=>{fe.close(e,t=>{t?r(t):i(t)})})};R.oswrite=function(e,i){return new Promise((r,t)=>{e.write(i,n=>{n?t(n):r()})})};R.osend=function(e){return new Promise((i,r)=>{e.end(t=>{t?r(t):i()})})};R.osopen=function(e,i){return new Promise((r,t)=>{let n=fe.createWriteStream(e,i);n.on("open",function(s){r(n)}),n.on("error",function(s){t(s)})})};R.fieldIndexOf=function(e,i){for(let r=0;r<e.length;++r){if(e[r].length!==i.length)continue;let t=!0;for(let n=0;n<i.length;++n)if(e[r][n]!==i[n]){t=!1;break}if(t)return r}return-1}});var Ue=T((Bd,zt)=>{"use strict";var Rs=ke(),Cs=Me(),Ms=re(),Sd=ee(),pi=class pi{constructor(i){this.schema=i,this.fields=Ut(i),this.fieldList=Dt(this.fields)}findField(i){i.constructor!==Array?i=i.split(","):i=i.slice(0);let r=this.fields;for(;i.length>1;i.shift())r=r[i[0]].fields;return r[i[0]]}findFieldBranch(i){i.constructor!==Array&&(i=i.split(","));let r=[],t=this.fields;for(;i.length>0;i.shift())r.push(t[i[0]]),i.length>1&&(t=t[i[0]].fields);return r}};d(pi,"ParquetSchema");var Ti=pi;function Ut(e,i,r,t){i||(i=0),r||(r=0),t||(t=[]);let n={};for(let s in e){let o=e[s],l=!o.optional,c=!!o.repeated,h=i,u=r,_="REQUIRED";if(l||(_="OPTIONAL",++u),c&&(_="REPEATED",++h,l&&++u),o.fields){n[s]={name:s,path:t.concat([s]),repetitionType:_,rLevelMax:h,dLevelMax:u,isNested:!0,statistics:o.statistics,fieldCount:Object.keys(o.fields).length,fields:Ut(o.fields,h,u,t.concat([s]))},(o.type=="LIST"||o.type=="MAP")&&(n[s].originalType=o.type);continue}let y=Ms.PARQUET_LOGICAL_TYPES[o.type];if(!y)throw"invalid parquet type: "+o.type;if(o.encoding||(o.encoding="PLAIN"),!(o.encoding in Rs))throw"unsupported parquet encoding: "+o.encodig;if(o.compression||(o.compression="UNCOMPRESSED"),!(o.compression in Cs.PARQUET_COMPRESSION_METHODS))throw"unsupported compression method: "+o.compression;n[s]={name:s,primitiveType:y.primitiveType,originalType:y.originalType,path:t.concat([s]),repetitionType:_,encoding:o.encoding,statistics:o.statistics,compression:o.compression,typeLength:o.typeLength||y.typeLength,rLevelMax:h,dLevelMax:u}}return n}d(Ut,"buildFields");function Dt(e){let i=[];for(let r in e)i.push(e[r]),e[r].isNested&&(i=i.concat(Dt(e[r].fields)));return i}d(Dt,"listFields");zt.exports={ParquetSchema:Ti}});var De=T(mi=>{"use strict";var qt=re(),xd=Ue();mi.shredRecord=function(e,i,r){var t={};for(let n of e.fieldList)t[n.path]={dlevels:[],rlevels:[],values:[],distinct_values:new Set,count:0};if(wi(e.fields,i,t,0,0),!("columnData"in r)||!("rowCount"in r)){r.rowCount=0,r.pageRowCount=0,r.columnData={},r.pages={};for(let n of e.fieldList)r.columnData[n.path]={dlevels:[],rlevels:[],values:[],distinct_values:new Set,count:0},r.pages[n.path]=[]}r.rowCount+=1,r.pageRowCount+=1;for(let n of e.fieldList){let s=t[n.path],o=r.columnData[n.path];for(let l=0;l<s.rlevels.length;l++)o.rlevels.push(s.rlevels[l]),o.dlevels.push(s.dlevels[l]),s.values[l]!==void 0&&o.values.push(s.values[l]);[...t[n.path].distinct_values].forEach(l=>r.columnData[n.path].distinct_values.add(l)),r.columnData[n.path].count+=t[n.path].count}};function wi(e,i,r,t,n){for(let s in e){let o=e[s],l=o.originalType||o.primitiveType,c=[];if(i&&s in i&&i[s]!==void 0&&i[s]!==null&&(i[s].constructor===Array?c=i[s]:c.push(i[s])),c.length==0&&i&&o.repetitionType==="REQUIRED")throw"missing required field: "+o.name;if(c.length>1&&o.repetitionType!=="REPEATED")throw"too many values for field: "+o.name;if(c.length==0){o.isNested?wi(o.fields,null,r,t,n):(r[o.path].rlevels.push(t),r[o.path].dlevels.push(n),r[o.path].count+=1);continue}for(let h=0;h<c.length;++h){let u=h===0?t:o.rLevelMax;o.isNested?wi(o.fields,c[h],r,u,o.dLevelMax):(r[o.path].distinct_values.add(c[h]),r[o.path].values.push(qt.toPrimitive(l,c[h])),r[o.path].rlevels.push(u),r[o.path].dlevels.push(o.dLevelMax),r[o.path].count+=1)}}}d(wi,"shredRecordInternal");mi.materializeRecords=function(e,i,r){r||(r=[]);for(let t in i.columnData){let n=e.findField(t),s=e.findFieldBranch(t),o=i.columnData[t].values[Symbol.iterator](),l=new Array(n.rLevelMax+1);l.fill(0);for(let c=0;c<i.columnData[t].count;++c){let h=i.columnData[t].dlevels[c],u=i.columnData[t].rlevels[c];l[u]++,l.fill(0,u+1);let _=null;h===n.dLevelMax&&(_=qt.fromPrimitive(n.originalType||n.primitiveType,o.next().value)),r[l[0]-1]=r[l[0]-1]||{},yi(r[l[0]-1],{values:s,cursor:0},{values:l,cursor:1},h,_)}}return r};function yi(e,i,r,t,n){let s=i.values[i.cursor];if(!(t<s.dLevelMax))if(i.values.length>i.cursor+1)if(s.repetitionType==="REPEATED"){for((s.name in e)||(e[s.name]=[]);e[s.name].length<r.values[r.cursor]+1;)e[s.name].push({});r.cursor++,i.cursor++,yi(e[s.name][r.values[r.cursor-1]],i,r,t,n)}else e[s.name]=e[s.name]||{},i.cursor++,yi(e[s.name],i,r,t,n);else if(s.repetitionType==="REPEATED"){for((s.name in e)||(e[s.name]=[]);e[s.name].length<r.values[r.cursor]+1;)e[s.name].push(null);e[s.name][r.values[r.cursor]]=n}else e[s.name]=n}d(yi,"materializeRecordField")});var Gt=T((bd,Vt)=>{var he;Vt.exports=(he=class{constructor(i,r){r=r||{},this.envelopeReader=i,this.maxSpan=r.maxSpan||1e5,this.maxLength=r.maxLength||1e7,this.queueWait=r.queueWait||5,this.scheduled=void 0,this.queue=[]}async read(i,r){return this.scheduled||(this.scheduled=!0,setTimeout(()=>{this.scheduled=!1,this.processQueue()},this.queueWait)),new Promise((t,n)=>{this.queue.push({offset:i,length:r,resolve:t,reject:n})})}async processQueue(){let i=this.queue;if(!i.length)return;this.queue=[],i.sort((n,s)=>n.offset-s.offset);var r=[];let t=d(async()=>{if(!r.length)return;let n=r;r=[];let s=n[n.length-1],o=n[0].offset,l=s.offset+s.length,c=await this.envelopeReader.readFn(o,l-o);n.forEach(async h=>{h.resolve(c.slice(h.offset-o,h.offset+h.length-o))})},"readSubqueue");i.forEach((n,s)=>{let o=i[s-1];!o||n.offset-(o.offset+o.length)<this.maxSpan?(r.push(n),n.offset+n.length-r[0].offset>this.maxLength&&t()):(t(),r=[n])}),t(r)}},d(he,"BufferReader"),he)});var gi=T((Nd,Yt)=>{var Us=ve(),Ds=X();function zs(e,i){if(i instanceof Ds.PageLocation)return[i[0],i[1],i[2]];if(typeof i=="object")for(let r in i)i[r]instanceof Date&&(i[r].toJSON=()=>({parquetType:"CTIME",value:i[r].valueOf()}));return i instanceof Us?isFinite(i)?+i:{parquetType:"INT64",value:[...i.buffer]}:i}d(zs,"replacer");Yt.exports=d(function(i,r){return i=Object.assign({},i,{json:!0}),JSON.stringify(i,zs,r)},"exportMetadata")});var Qt=T((Ad,Zt)=>{"use strict";var qs=ve(),N=X(),vi=De(),B=ee(),Vs=Ue(),Wt=ke(),Si=Me(),Gs=re(),Ys=Gt(),Ws=gi(),ue="PAR1",js=1,ze="INT32",jt="RLE",Bi=class Bi{constructor(i,r,t,n){this.metadata=i,this.envelopeReader=r,this.schema=t,this.columnList=n,this.rowGroup=[],this.rowGroupIndex=0}async next(){if(this.rowGroup.length===0){if(this.rowGroupIndex>=this.metadata.row_groups.length)return null;let i=await this.envelopeReader.readRowGroup(this.schema,this.metadata.row_groups[this.rowGroupIndex],this.columnList);this.rowGroup=vi.materializeRecords(this.schema,i),this.rowGroupIndex++}return this.rowGroup.shift()}async nextRowGroup(){if(this.rowGroupIndex>=this.metadata.row_groups.length)return null;let i=await this.envelopeReader.readRowGroup(this.schema,this.metadata.row_groups[this.rowGroupIndex],this.columnList);return this.rowGroup=vi.materializeRecords(this.schema,i),this.rowGroupIndex++,this.rowGroup}rewind(){this.rowGroup=[],this.rowGroupIndex=0}};d(Bi,"ParquetCursor");var Ii=Bi,_e=class _e{static async openFile(i,r){let t=await H.openFile(i,r);return this.openEnvelopeReader(t,r)}static async openBuffer(i,r){let t=await H.openBuffer(i,r);return this.openEnvelopeReader(t,r)}static async openS3(i,r,t){let n=await H.openS3(i,r,t);return this.openEnvelopeReader(n,t)}static async openUrl(i,r,t){let n=await H.openUrl(i,r,t);return this.openEnvelopeReader(n,t)}static async openEnvelopeReader(i,r){if(r&&r.metadata)return new _e(r.metadata,i,r);try{await i.readHeader();let t=await i.readFooter();return new _e(t,i,r)}catch(t){throw await i.close(),t}}constructor(i,r,t){if(t=t||{},i.version!=js)throw"invalid parquet version";if(i.json){let n=d(s=>{if(s&&typeof s=="object"){if(Object.keys(s).forEach(o=>s[o]=n(s[o])),s.parquetType==="CTIME")return new Date(s.value);if(s.parquetType==="INT64")return new qs(Buffer.from(s.value))}return s},"convert");i.row_groups.forEach(s=>{s.columns.forEach(o=>{o.offsetIndex&&o.offsetIndex.page_locations.forEach(l=>{Array.isArray(l)&&Object.setPrototypeOf(l,N.PageLocation.prototype)})})}),n(i)}this.metadata=r.metadata=i,this.envelopeReader=r,this.schema=r.schema=new Vs.ParquetSchema(Qs(this.metadata.schema.slice(1))),this.metadata.row_groups&&!this.metadata.json&&!t.rawStatistics&&this.metadata.row_groups.forEach(n=>n.columns.forEach(s=>{let o=s.meta_data.statistics;if(o){let l=this.schema.findField(s.meta_data.path_in_schema);o.max_value=z(o.max_value,l),o.min_value=z(o.min_value,l),o.min=z(o.min,l),o.max=z(o.max,l)}}))}getCursor(i){return i||(i=[]),i=i.map(r=>r.constructor===Array?r:[r]),new Ii(this.metadata,this.envelopeReader,this.schema,i)}getRowCount(){return this.metadata.num_rows}getSchema(){return this.schema}getMetadata(){let i={};for(let r of this.metadata.key_value_metadata)i[r.key]=r.value;return i}exportMetadata(i){return Ws(this.metadata,i)}async close(){await this.envelopeReader.close(),this.envelopeReader=null,this.metadata=null}decodePages(i,r){return Kt(i,r)}};d(_e,"ParquetReader");var Ei=_e,Hs=0,j=class j{static async openFile(i,r){let t=await B.fstat(i),n=await B.fopen(i),s=d((l,c,h)=>h?Promise.reject("external references are not supported"):B.fread(n,l,c),"readFn"),o=B.fclose.bind(void 0,n);return new j(s,o,t.size,r)}static async openBuffer(i,r){let t=d((s,o,l)=>l?Promise.reject("external references are not supported"):Promise.resolve(i.slice(s,s+o)),"readFn"),n=d(()=>({}),"closeFn");return new j(t,n,i.length,r)}static async openS3(i,r,t){let n=d(async()=>i.headObject(r).promise().then(l=>l.ContentLength),"fileStat"),s=d(async(l,c,h)=>{if(h)return Promise.reject("external references are not supported");let u=`bytes=${l}-${l+c-1}`,_=await i.getObject(Object.assign({Range:u},r)).promise();return Promise.resolve(_.Body)},"readFn"),o=d(()=>({}),"closeFn");return new j(s,o,n,t)}static async openUrl(i,r,t){if(typeof r=="string"&&(r={url:r}),!r.url)throw new Error("URL missing");let n=r.url.split("/");n=n.slice(0,n.length-1).join("/")+"/",r.encoding=r.encoding||null;let s=r.headers||{},o=d(async()=>new Promise((h,u)=>{let _=i(r);_.on("response",y=>{_.abort(),h(y.headers["content-length"])}),_.on("error",u)}),"filesize"),l=d((h,u,_)=>{let y=_?n+_:r.url,w=`bytes=${h}-${h+u-1}`,m=Object.assign({},s,{range:w}),v=Object.assign({},r,{headers:m,url:y});return new Promise((S,U)=>{i(v,(k,O)=>{k?U(k):S(O.body)})})},"readFn"),c=d(()=>({}),"closeFn");return new j(l,c,o,t)}constructor(i,r,t,n){if(n=n||{},this.readFn=i,this.id=++Hs,this.close=r,this.fileSize=t,this.default_dictionary_size=n.default_dictionary_size||1e7,n.maxLength||n.maxSpan||n.queueWait){let s=new Ys(this,n);this.read=(o,l)=>s.read(o,l)}}read(i,r,t){return this.readFn(i,r,t)}readHeader(){return this.read(0,ue.length).then(i=>{if(i.toString()!=ue)throw"not valid parquet file"})}getColumn(i,r){let t;if(isNaN(r)||(r=this.metadata.row_groups[r]),typeof i=="string"){if(!r)throw`Missing RowGroup ${r}`;if(t=r.columns.find(n=>n.meta_data.path_in_schema.join(",")===i),!t)throw`Column ${i} Not Found`}else t=i;return t}readOffsetIndex(i,r,t){let n=this.getColumn(i,r);if(n.offsetIndex)return Promise.resolve(n.offsetIndex);if(!n.offset_index_offset||!n.offset_index_length)return Promise.reject("Offset Index Missing");let s=this.read(+n.offset_index_offset,n.offset_index_length).then(o=>{let l=new N.OffsetIndex;return B.decodeThrift(l,o),Object.defineProperty(l,"column",{value:n,enumerable:!1}),t&&t.cache&&(n.offsetIndex=l),l});return t&&t.cache&&(n.offsetIndex=s),s}readColumnIndex(i,r,t){let n=this.getColumn(i,r);if(n.columnIndex)return Promise.resolve(n.columnIndex);if(!n.column_index_offset)return Promise.reject(new Error("Column Index Missing"));let s=this.read(+n.column_index_offset,n.column_index_length).then(o=>{let l=new N.ColumnIndex;B.decodeThrift(l,o),Object.defineProperty(l,"column",{value:n});let c=this.schema.findField(n.meta_data.path_in_schema);return l.max_values&&(l.max_values=l.max_values.map(h=>z(h,c))),l.min_values&&(l.min_values=l.min_values.map(h=>z(h,c))),t&&t.cache&&(n.columnIndex=l),l});return t&&t.cache&&(n.columnIndex=s),s}async readPage(i,r,t,n){if(i=Object.assign({},i),i.meta_data=Object.assign({},i.meta_data),r.offset!==void 0){if(isNaN(r.offset)||isNaN(r.compressed_page_size))throw Error("page offset and/or size missing");i.meta_data.data_page_offset=r.offset,i.meta_data.total_compressed_size=r.compressed_page_size}else{let l=i.offsetIndex||await this.readOffsetIndex(i,null,n);i.meta_data.data_page_offset=l.page_locations[r].offset,i.meta_data.total_compressed_size=l.page_locations[r].compressed_page_size}let s=await this.readColumnChunk(this.schema,i);Object.defineProperty(s,"column",{value:i});let o={columnData:{[s.column.meta_data.path_in_schema.join(",")]:s}};return vi.materializeRecords(this.schema,o,t)}async readRowGroup(i,r,t){var n={rowCount:+r.num_rows,columnData:{}};for(let s of r.columns){let l=s.meta_data.path_in_schema;t.length>0&&B.fieldIndexOf(t,l)<0||(n.columnData[l]=await this.readColumnChunk(i,s))}return n}readColumnChunk(i,r,t){let n=Promise.resolve(),s=i.findField(r.meta_data.path_in_schema),o=B.getThriftEnum(N.Type,r.meta_data.type),l=B.getThriftEnum(N.CompressionCodec,r.meta_data.codec),c=+r.meta_data.data_page_offset,h=+r.meta_data.total_compressed_size;if(r.file_path||(h=Math.min(this.fileSize-c,+r.meta_data.total_compressed_size)),t=Object.assign({},t,{type:o,rLevelMax:s.rLevelMax,dLevelMax:s.dLevelMax,compression:l,column:s,num_values:r.meta_data.num_values}),r.meta_data.dictionary_page_offset){let u=+r.meta_data.dictionary_page_offset,_=Math.min(+this.fileSize-u,this.default_dictionary_size);n=this.read(u,_,r.file_path).then(y=>Jt({offset:0,buffer:y,size:y.length},t).dictionary)}return n.then(u=>(t.dictionary=t.dictionary||u,this.read(c,h,r.file_path).then(_=>Kt(_,t))))}async readFooter(){typeof this.fileSize=="function"&&(this.fileSize=await this.fileSize());let i=ue.length+4,r=await this.read(this.fileSize-i,i);if(r.slice(4).toString()!=ue)throw"not a valid parquet file";let t=r.readUInt32LE(0),n=this.fileSize-t-i;if(n<ue.length)throw"invalid metadata size";let s=await this.read(n,t),o=new N.FileMetaData;return B.decodeThrift(o,s),o}};d(j,"ParquetEnvelopeReader");var H=j;function W(e,i,r,t,n){if(!(i in Wt))throw"invalid encoding: "+i;return Wt[i].decodeValues(e,r,t,n)}d(W,"decodeValues");function z(e,i){if(!(e===null||!e.length))return i.primitiveType.includes("BYTE_ARRAY")||(e=W(i.primitiveType,"PLAIN",{buffer:Buffer.from(e),offset:0},1,i),e.length===1&&(e=e[0])),i.originalType&&(e=Gs.fromPrimitive(i.originalType,e)),e}d(z,"decodeStatisticsValue");function Ht(e,i){if(e)return e.min_value!==null&&(e.min_value=z(e.min_value,i)),e.max_value!==null&&(e.max_value=z(e.max_value,i)),e.min=z(e.min,i)||e.min_value,e.max=z(e.max,i)||e.max_value,e}d(Ht,"decodeStatistics");function Jt(e,i){i=i||{};let r,t=new N.PageHeader,n=e.offset,s=B.decodeThrift(t,e.buffer.slice(e.offset));e.offset+=s;let o=B.getThriftEnum(N.PageType,t.type);switch(o){case"DATA_PAGE":i.rawStatistics||(t.data_page_header.statistics=Ht(t.data_page_header.statistics,i.column)),r=Ks(e,t,i);break;case"DATA_PAGE_V2":i.rawStatistics||(t.data_page_header_v2.statistics=Ht(t.data_page_header_v2.statistics,i.column)),r=Zs(e,t,i);break;case"DICTIONARY_PAGE":r={dictionary:Js(e,t,i)};break;default:throw`invalid page type: ${o}`}return t.offset=n,t.headerSize=s,r.pageHeader=t,r}d(Jt,"decodePage");function Kt(e,i){i=i||{};let r={buffer:e,offset:0,size:e.length},t={rlevels:[],dlevels:[],values:[],pageHeaders:[],count:0};for(;r.offset<r.size&&(!i.num_values||t.dlevels.length<i.num_values);){let n=Jt(r,i);if(n.dictionary){i.dictionary=n.dictionary;continue}i.dictionary&&(n.values=n.values.map(s=>i.dictionary[s]));for(let s=0;s<n.rlevels.length;s++){t.rlevels.push(n.rlevels[s]),t.dlevels.push(n.dlevels[s]);let o=n.values[s];o!==void 0&&t.values.push(o)}t.count+=n.count,t.pageHeaders.push(n.pageHeader)}return t}d(Kt,"decodePages");function Js(e,i,r){let t=e.offset+i.compressed_page_size,n={offset:0,buffer:e.buffer.slice(e.offset,t),size:t-e.offset};if(e.offset=t,r.compression&&r.compression!=="UNCOMPRESSED"){let s=Si.inflate(r.compression,n.buffer.slice(n.offset,t));n={buffer:s,offset:0,size:s.length}}return W(r.column.primitiveType,r.column.encoding,n,i.dictionary_page_header.num_values,r).map(s=>s.toString())}d(Js,"decodeDictionaryPage");function Ks(e,i,r){let t=e.offset+i.compressed_page_size,n=i.data_page_header.num_values,s=B.getThriftEnum(N.Encoding,i.data_page_header.encoding),o=e;if(r.compression&&r.compression!=="UNCOMPRESSED"){let w=Si.inflate(r.compression,e.buffer.slice(e.offset,t));o={buffer:w,offset:0,size:w.length}}let l=B.getThriftEnum(N.Encoding,i.data_page_header.repetition_level_encoding),c=new Array(n);r.rLevelMax>0?c=W(ze,l,o,n,{bitWidth:B.getBitWidth(r.rLevelMax)}):c.fill(0);let h=B.getThriftEnum(N.Encoding,i.data_page_header.definition_level_encoding),u=new Array(n);r.dLevelMax>0?u=W(ze,h,o,n,{bitWidth:B.getBitWidth(r.dLevelMax)}):u.fill(0);let _=0;for(let w of u)w===r.dLevelMax&&++_;let y=W(r.type,s,o,_,{typeLength:r.column.typeLength,bitWidth:r.column.typeLength,disableEnvelope:r.column.disableEnvelope});return e.offset=t,{dlevels:u,rlevels:c,values:y,count:n}}d(Ks,"decodeDataPage");function Zs(e,i,r){let t=e.offset+i.compressed_page_size,n=i.data_page_header_v2.num_values,s=n-i.data_page_header_v2.num_nulls,o=B.getThriftEnum(N.Encoding,i.data_page_header_v2.encoding),l=new Array(n);r.rLevelMax>0?l=W(ze,jt,e,n,{bitWidth:B.getBitWidth(r.rLevelMax),disableEnvelope:!0}):l.fill(0);let c=new Array(n);r.dLevelMax>0?c=W(ze,jt,e,n,{bitWidth:B.getBitWidth(r.dLevelMax),disableEnvelope:!0}):c.fill(0);let h=e;if(i.data_page_header_v2.is_compressed){let _=Si.inflate(r.compression,e.buffer.slice(e.offset,t));h={buffer:_,offset:0,size:_.length},e.offset=t}let u=W(r.type,o,h,s,{typeLength:r.column.typeLength,bitWidth:r.column.typeLength});return{dlevels:c,rlevels:l,values:u,count:n}}d(Zs,"decodeDataPageV2");function Qs(e){let i={};return e.forEach(r=>{let t=B.getThriftEnum(N.FieldRepetitionType,r.repetition_type),n=!1,s=!1;switch(t){case"REQUIRED":break;case"OPTIONAL":n=!0;break;case"REPEATED":s=!0;break}if(r.num_children>0)i[r.name]={optional:n,repeated:s,fields:Object.create({},{parent:{value:i,enumerable:!1},num_children:{value:r.num_children,enumerable:!1}})},i=i[r.name].fields;else{let o=B.getThriftEnum(N.Type,r.type);r.converted_type!=null&&(o=B.getThriftEnum(N.ConvertedType,r.converted_type)),i[r.name]={type:o,typeLength:r.type_length,optional:n,repeated:s}}for(;i.parent&&Object.keys(i).length===i.num_children;)i=i.parent}),i}d(Qs,"decodeSchema");Zt.exports={ParquetEnvelopeReader:H,ParquetReader:Ei}});var rr=T((Cd,tr)=>{"use strict";var Xs=require("stream"),E=X(),$s=De(),C=ee(),Xt=ke(),$t=Me(),ea=re(),ia=gi(),er="PAR1",ta=1,ra=8192,na=4096,qe="INT32",J="RLE",Te=class Te{static async openFile(i,r,t){let n=await C.osopen(r,t);return Te.openStream(i,n,t)}static async openStream(i,r,t){t||(t={});let n=await pe.openStream(i,r,t);return new Te(i,n,t)}constructor(i,r,t){this.schema=i,this.envelopeWriter=r,this.rowBuffer={},this.rowGroupSize=t.rowGroupSize||na,this.closed=!1,this.userMetadata={};try{r.writeHeader()}catch(n){throw r.close(),n}}async appendRow(i){if(this.closed)throw"writer was closed";$s.shredRecord(this.schema,i,this.rowBuffer),this.rowBuffer.pageRowCount>=this.envelopeWriter.pageSize&&Fi(this.schema,this.rowBuffer,{useDataPageV2:this.envelopeWriter.useDataPageV2}),this.rowBuffer.rowCount>=this.rowGroupSize&&(Fi(this.schema,this.rowBuffer,{useDataPageV2:this.envelopeWriter.useDataPageV2}),await this.envelopeWriter.writeRowGroup(this.rowBuffer),this.rowBuffer={})}async close(i){if(this.closed)throw"writer was closed";this.closed=!0,(this.rowBuffer.rowCount>0||this.rowBuffer.rowCount>=this.rowGroupSize)&&(Fi(this.schema,this.rowBuffer,{useDataPageV2:this.envelopeWriter.useDataPageV2}),await this.envelopeWriter.writeRowGroup(this.rowBuffer),this.rowBuffer={}),await this.envelopeWriter.writeIndex(),await this.envelopeWriter.writeFooter(this.userMetadata),await this.envelopeWriter.close(),i&&i()}setMetadata(i,r){this.userMetadata[i.toString()]=r.toString()}setRowGroupSize(i){this.rowGroupSize=i}setPageSize(i){this.writer.setPageSize(i)}};d(Te,"ParquetWriter");var Ve=Te,Ye=class Ye{static async openStream(i,r,t){let n=C.oswrite.bind(void 0,r),s=C.osend.bind(void 0,r);return new Ye(i,n,s,0,t)}constructor(i,r,t,n,s){this.schema=i,this.write=r,this.close=t,this.offset=n,this.rowCount=0,this.rowGroups=[],this.pageSize=s.pageSize||ra,this.useDataPageV2="useDataPageV2"in s?s.useDataPageV2:!0,this.pageIndex=s.pageIndex}writeSection(i){return this.offset+=i.length,this.write(i)}writeHeader(){return this.writeSection(Buffer.from(er))}writeRowGroup(i){let r=da(this.schema,i,{baseOffset:this.offset,pageSize:this.pageSize,useDataPageV2:this.useDataPageV2,pageIndex:this.pageIndex});return this.rowCount+=i.rowCount,this.rowGroups.push(r.metadata),this.writeSection(r.body)}writeIndex(i){let r=i||this.rowGroups;this.schema.fieldList.forEach((t,n)=>{r.forEach(s=>{let o=s.columns[n];if(o){if(o.meta_data.columnIndex){let l=C.serializeThrift(o.meta_data.columnIndex);delete o.meta_data.columnIndex,o.column_index_offset=this.offset,o.column_index_length=l.length,this.writeSection(l)}if(o.meta_data.offsetIndex){let l=C.serializeThrift(o.meta_data.offsetIndex);delete o.meta_data.offsetIndex,o.offset_index_offset=this.offset,o.offset_index_length=l.length,this.writeSection(l)}}})})}writeFooter(i,r,t,n){if(i||(i={}),this.schema.fieldList.length===0)throw"cannot write parquet file with zero fieldList";return this.writeSection(la(this.schema,this.rowCount,this.rowGroups,i))}exportMetadata(i){let r=ir(this.schema,this.rowCount,this.rowGroups,{});return console.log("metadata",r),ia(r,i||2)}setPageSize(i){this.pageSize=i}};d(Ye,"ParquetEnvelopeWriter");var pe=Ye,Pi=class Pi extends Xs.Transform{constructor(i,r={}){super({objectMode:!0});let t=function(n){return function(s){n.push(s)}}(this);this.writer=new Ve(i,new pe(i,t,function(){},0,r),r)}_transform(i,r,t){i?this.writer.appendRow(i).then(n=>t(null,n),t):t()}_flush(i){this.writer.close(i).then(r=>i(null,r),i)}};d(Pi,"ParquetTransformer");var xi=Pi;function K(e,i,r,t){if(!(i in Xt))throw"invalid encoding: "+i;return Xt[i].encodeValues(e,r,t)}d(K,"encodeValues");function Ge(e,i){return e===void 0?Buffer.alloc(0):(i.originalType&&(e=ea.toPrimitive(i.originalType,e)),i.primitiveType!=="BYTE_ARRAY"&&(e=K(i.primitiveType,"PLAIN",[e],i)),e)}d(Ge,"encodeStatisticsValue");function Li(e,i){return e=Object.assign({},e),e.min_value=e.min_value===void 0?null:Ge(e.min_value,i),e.max_value=e.max_value===void 0?null:Ge(e.max_value,i),e.max=e.max_value,e.min=e.min_value,new E.Statistics(e)}d(Li,"encodeStatistics");function Fi(e,i,r){if(i.pageRowCount){for(let t of e.fieldList){if(t.isNested)continue;let n,s=i.columnData[t.path],o;t.statistics!==!1&&(o={},[...s.distinct_values].forEach((u,_)=>{(_===0||u>o.max_value)&&(o.max_value=u),(_===0||u<o.min_value)&&(o.min_value=u)}),o.null_count=s.dlevels.length-s.values.length,o.distinct_count=s.distinct_values.size),r.useDataPageV2?n=aa(t,s.count,s.values,s.rlevels,s.dlevels,o):n=sa(t,s.values,s.rlevels,s.dlevels,o);let l=i.pages[t.path],c=l[l.length-1],h=c?c.first_row_index+c.count:0;l.push({page:n,statistics:o,first_row_index:h,distinct_values:s.distinct_values,num_values:s.dlevels.length}),s.distinct_values=new Set,s.values=[],s.rlevels=[],s.dlevels=[],s.count=0}i.pageRowCount=0}}d(Fi,"encodePages");function sa(e,i,r,t,n){let s=K(e.primitiveType,e.encoding,i,{typeLength:e.typeLength,bitWidth:e.typeLength}),o=Buffer.alloc(0);e.rLevelMax>0&&(o=K(qe,J,r,{bitWidth:C.getBitWidth(e.rLevelMax)}));let l=Buffer.alloc(0);e.dLevelMax>0&&(l=K(qe,J,t,{bitWidth:C.getBitWidth(e.dLevelMax)}));let c=Buffer.concat([o,l,s]);c=$t.deflate(e.compression,c);let h=new E.PageHeader;return h.type=E.PageType.DATA_PAGE,h.uncompressed_page_size=o.length+l.length+s.length,h.compressed_page_size=c.length,h.data_page_header=new E.DataPageHeader,h.data_page_header.num_values=t.length,e.statistics!==!1&&(h.data_page_header.statistics=Li(n,e)),h.data_page_header.encoding=E.Encoding[e.encoding],h.data_page_header.definition_level_encoding=E.Encoding[J],h.data_page_header.repetition_level_encoding=E.Encoding[J],Buffer.concat([C.serializeThrift(h),c])}d(sa,"encodeDataPage");function aa(e,i,r,t,n,s){let o=K(e.primitiveType,e.encoding,r,{typeLength:e.typeLength,bitWidth:e.typeLength}),l=$t.deflate(e.compression,o),c=Buffer.alloc(0);e.rLevelMax>0&&(c=K(qe,J,t,{bitWidth:C.getBitWidth(e.rLevelMax),disableEnvelope:!0}));let h=Buffer.alloc(0);e.dLevelMax>0&&(h=K(qe,J,n,{bitWidth:C.getBitWidth(e.dLevelMax),disableEnvelope:!0}));let u=new E.PageHeader;return u.type=E.PageType.DATA_PAGE_V2,u.data_page_header_v2=new E.DataPageHeaderV2,u.data_page_header_v2.num_values=n.length,u.data_page_header_v2.num_nulls=n.length-r.length,u.data_page_header_v2.num_rows=i,e.statistics!==!1&&(u.data_page_header_v2.statistics=Li(s,e)),u.uncompressed_page_size=c.length+h.length+o.length,u.compressed_page_size=c.length+h.length+l.length,u.data_page_header_v2.encoding=E.Encoding[e.encoding],u.data_page_header_v2.definition_levels_byte_length=h.length,u.data_page_header_v2.repetition_levels_byte_length=c.length,u.data_page_header_v2.is_compressed=e.compression!=="UNCOMPRESSED",Buffer.concat([C.serializeThrift(u),c,h,l])}d(aa,"encodeDataPageV2");function oa(e,i){let r=Buffer.concat(e.map(w=>w.page)),t=e.reduce((w,m)=>w+m.num_values,0),n=i.baseOffset,s=new E.ColumnMetaData;s.path_in_schema=i.column.path,s.num_values=t,s.data_page_offset=i.baseOffset,s.encodings=[],s.total_uncompressed_size=r.length,s.total_compressed_size=r.length,s.type=E.Type[i.column.primitiveType],s.codec=E.CompressionCodec[i.column.compression];let o=new E.ColumnIndex;o.max_values=[],o.min_values=[];let l=new E.OffsetIndex;l.page_locations=[];let c={},h=new Set;c.null_count=0,c.distinct_count=0;for(let w=0;w<e.length;w++){let m=e[w];i.column.statistics!==!1&&((m.statistics.max_value>c.max_value||w==0)&&(c.max_value=m.statistics.max_value),(m.statistics.min_value<c.min_value||w==0)&&(c.min_value=m.statistics.min_value),c.null_count+=m.statistics.null_count,m.distinct_values.forEach(S=>h.add(S)),o.max_values.push(Ge(m.statistics.max_value,i.column)),o.min_values.push(Ge(m.statistics.min_value,i.column)));let v=new E.PageLocation;v.offset=n,n+=m.page.length,v.compressed_page_size=m.page.length,v.first_row_index=m.first_row_index,l.page_locations.push(v)}i.pageIndex!==!1&&(s.offsetIndex=l),i.column.statistics!==!1&&(c.distinct_count=h.size,s.statistics=Li(c,i.column),i.pageIndex!==!1&&(s.columnIndex=o));let u={};u[J]=!0,u[i.column.encoding]=!0;for(let w in u)s.encodings.push(E.Encoding[w]);let _=i.baseOffset+r.length;return{body:Buffer.concat([r,C.serializeThrift(s)]),metadata:s,metadataOffset:_}}d(oa,"encodeColumnChunk");function da(e,i,r){let t=new E.RowGroup;t.num_rows=i.rowCount,t.columns=[],t.total_byte_size=0;let n=Buffer.alloc(0);for(let s of e.fieldList){if(s.isNested)continue;let o=oa(i.pages[s.path],{column:s,baseOffset:r.baseOffset+n.length,pageSize:r.pageSize,encoding:s.encoding,rowCount:i.rowCount,useDataPageV2:r.useDataPageV2,pageIndex:r.pageIndex}),l=new E.ColumnChunk;l.file_offset=o.metadataOffset,l.meta_data=o.metadata,t.columns.push(l),t.total_byte_size+=o.body.length,n=Buffer.concat([n,o.body])}return{body:n,metadata:t}}d(da,"encodeRowGroup");function ir(e,i,r,t){let n=new E.FileMetaData;n.version=ta,n.created_by="parquet.js",n.num_rows=i,n.row_groups=r,n.schema=[],n.key_value_metadata=[];for(let s in t){let o=new E.KeyValue;o.key=s,o.value=t[s],n.key_value_metadata.push(o)}{let s=new E.SchemaElement;s.name="root",s.num_children=Object.keys(e.fields).length,n.schema.push(s)}for(let s of e.fieldList){let o=new E.SchemaElement;o.name=s.name,o.repetition_type=E.FieldRepetitionType[s.repetitionType],s.isNested?o.num_children=s.fieldCount:o.type=E.Type[s.primitiveType],s.originalType&&(o.converted_type=E.ConvertedType[s.originalType]),o.type_length=s.typeLength,n.schema.push(o)}return n}d(ir,"getMetadata");function la(e,i,r,t){let n=ir(e,i,r,t),s=C.serializeThrift(n),o=Buffer.alloc(s.length+8);return s.copy(o),o.writeUInt32LE(s.length,s.length),o.write(er,s.length+4),o}d(la,"encodeFooter");tr.exports={ParquetEnvelopeWriter:pe,ParquetWriter:Ve,ParquetTransformer:xi}});var ar=T((Ud,sr)=>{var nr=Qt(),bi=rr(),fa=Ue(),ca=De(),ha=ee();sr.exports={ParquetEnvelopeReader:nr.ParquetEnvelopeReader,ParquetReader:nr.ParquetReader,ParquetEnvelopeWriter:bi.ParquetEnvelopeWriter,ParquetWriter:bi.ParquetWriter,ParquetTransformer:bi.ParquetTransformer,ParquetSchema:fa.ParquetSchema,ParquetShredder:ca,force32:ha.force32}});var dr=T((Dd,or)=>{var ua=d(e=>!isNaN(parseInt(e)),"isNumber");or.exports=ua});var fr=T((qd,lr)=>{function _a(e){let i={};return e.forEach(r=>{for(r.num_children>0?(i[r.name]=Object.assign(r,{isNested:!0,fieldCount:r.num_children,fields:Object.create({},{parent:{value:i,enumerable:!1},num_children:{value:r.num_children,enumerable:!1}})}),i=i[r.name].fields):i[r.name]={...r};i.parent&&Object.keys(i).length===i.num_children;)i=i.parent}),i}d(_a,"generateSchemaFieldsTree");lr.exports=_a});var ur=T((Gd,hr)=>{var Ta=["num_children","parent"],pa=d((e,i,r)=>{let t=r.concat([e]);return i.fields?{...i,fields:cr(i.fields,t)}:{...i,path:t}},"defineFieldPath"),cr=d((e,i=[])=>Object.entries(e).reduce((r,[t,n])=>Ta.includes(t)?r:{...r,[t]:pa(t,n,i)},{}),"defineSchemaFieldsPath");hr.exports=cr});var Tr=T((Wd,_r)=>{var wa=d((e,i)=>Array.isArray(e)&&Array.isArray(i)&&e.length===i.length&&e.every((r,t)=>i[t]===r),"areArraysEqual");_r.exports=wa});var wr=T((Hd,pr)=>{var ya=Tr(),ma=d((e,i)=>e.find(r=>ya(r.meta_data.path_in_schema,i.path)),"getFieldAdditionalData");pr.exports=ma});var We=T((Kd,yr)=>{var ga=d((e=[])=>i=>e.reduce((r,t)=>t(r),i),"pipe");yr.exports=ga});var je=T((Qd,mr)=>{var va="map",Ia="list",Ea="key_value",Sa="element",Ba="key",Fa="value",xa="group";mr.exports={MAP:va,LIST:Ia,KEY_VALUE:Ea,ELEMENT:Sa,KEY:Ba,VALUE:Fa,GROUP:xa}});var Oi=T((Xd,Ir)=>{var ye=ee(),me=X(),we=dr(),La=fr(),Pa=ur(),ba=wr(),Oa=We(),{KEY_VALUE:Na}=je(),ka=d(e=>({repetitionType:ye.getThriftEnum(me.FieldRepetitionType,e)}),"transformRepetitionType"),Aa=d(e=>({primitiveType:ye.getThriftEnum(me.Type,e)}),"transformType"),Ra=d(e=>({originalType:ye.getThriftEnum(me.ConvertedType,e)}),"transformConvertedType"),Ca=d(e=>({compression:ye.getThriftEnum(me.CompressionCodec,e)}),"transformCodec"),Ma=d(e=>({encoding:e.map(i=>ye.getThriftEnum(me.Encoding,i))}),"transformEncoding"),Ua=d((e,i)=>{switch(e){case"name":return{name:i};case"type":return we(i)?Aa(i):{};case"repetition_type":return we(i)?ka(i):{};case"converted_type":return we(i)?Ra(i):{};case"scale":return we(i)?{scale:i}:{};case"precision":return we(i)?{precision:i}:{};case"num_children":return{num_children:i};case"codec":return Ca(i);case"encodings":return Ma(i)}},"transformFieldProperty"),gr=d(e=>Object.entries(e).reduce((i,[r,t])=>Object.assign(i,Ua(r,t)),{}),"transformField"),vr=d(e=>i=>Object.entries(i).reduce((r,[t,n])=>{if(t==="parent")return r;if(n.fields)return Object.assign(r,{[t]:{...n,fields:vr(e)(n.fields)}});let s=ba(e,n),o=s?s.meta_data:{};return Object.assign(r,{[t]:{...n,...gr(o)}})},{}),"defineFieldAdditionalData"),Da=d(e=>{let[i]=e.row_groups;return(i==null?void 0:i.columns)||[]},"getFieldsMetadata"),za=d((e,i)=>Array.isArray(e.row_groups)?e.row_groups.map((r,t)=>({rowGroupName:`Row group ${t}`,rowGroupColumns:(r.columns||[]).map(n=>({name:n.meta_data.path_in_schema.filter(s=>s!==Na).join(".")}))})):[],"getRowGroups"),qa=d(e=>{let{schema:i}=e,r=Da(e),t=i.slice(1).map(n=>gr(n));return Oa([La,Pa,vr(r)])(t)},"transformMetadata");Ir.exports={transformMetadata:qa,getRowGroups:za}});var Sr=T((el,Er)=>{var Va=ar(),Ga=Oi(),{getRowGroups:Ya}=Oi(),Wa=d(async e=>{let i=await Va.ParquetEnvelopeReader.openFile(e);await i.readHeader();let r=await i.readFooter();return await i.close(),r},"getRawMetadataFromFile"),ja=d(async e=>{try{let i=await Wa(e),{key_value_metadata:r,created_by:t}=i,n=Ga.transformMetadata(i);return{metadata:{key_value_metadata:r,created_by:t},schema:n,rowGroups:Ya(i,n)}}catch(i){throw new Error(i)}},"readParquetFile");Er.exports={readParquetFile:ja}});var xr=T((tl,Fr)=>{var{MAP:Ha,LIST:Br,ELEMENT:Ja,KEY:Ka,KEY_VALUE:Za,VALUE:Qa,GROUP:Xa}=je(),$a=d(e=>{let[i]=Object.values(e.fields),[r,t]=Object.values(i.fields||{});return e.fieldCount===1&&i.fieldCount===2&&i&&i.name===Za&&r&&r.name===Ka&&t&&t.name===Qa},"isMap"),eo=d(e=>{let[i]=Object.values(e.fields),[r]=Object.values(i.fields||{});return e.fieldCount===1&&i.fieldCount===1&&i&&i.name===Br&&r&&r.name===Ja},"isList"),io=d(e=>{switch(!0){case $a(e):return Ha;case eo(e):return Br;default:return Xa}},"defineGroupType");Fr.exports=io});var Pr=T((nl,Lr)=>{var to=d(e=>e.indexOf("INT")===0?{type:"int",bitWidth:e.slice(3)}:e.toLowerCase()==="byte_array"?{type:"binary"}:{type:e.toLowerCase()},"reverseType"),ro=d(e=>isNaN(e)?{}:{byteLength:Number(e)},"reverseTypeLength"),no=d(e=>{let i=e.toLowerCase();return{compressionCodec:{uncompressed:"Uncompressed",snappy:"Snappy",gzip:"GZip",lzo:"LZO",brotli:"BROTLI",lz4:"LZ4",zst:"ZST"}[i]||e}},"reverseCompression"),so=d(e=>{let i={plain:"Plain",group_var_int:"Group_Var_Int",plain_dictionary:"Plain_Dictionary",rle:"RLE",bit_packed:"Bit_Packed",delta_binary_packed:"Delta_Binary_Packed",delta_length_byte_array:"Delta_Length_Byte_Array",delta_byte_array:"Delta_Byte_Array",rle_dictionary:"RLE_Dictionary"};if(Array.isArray(e))return{encoding:e.map(n=>i[n.toLowerCase()]||e)};let r=e.toLowerCase();return{encoding:[i[r]||e]}},"reverseEncoding"),ao=d(e=>e==="DECIMAL"?{decimal:!0}:{logicalType:e},"reverseOriginalType"),oo=d((e,i)=>{switch(e){case"primitiveType":return to(i);case"encoding":return so(i);case"repetitionType":return{repetition:i.toLowerCase()};case"compression":return no(i);case"typeLength":return ro(i);case"originalType":return ao(i);case"precision":return{precision:i};case"scale":return{scale:i}}},"reverseProperty"),lo=d(e=>Object.entries(e).reduce((i,[r,t])=>Object.assign(i,oo(r,t)),{}),"reverseFieldSchema");Lr.exports=lo});var Or=T((al,br)=>{var{MAP:fo,LIST:co}=je(),ho=d((e,i)=>i===fo||i===co?Object.values(e.fields)[0].fields:e.fields,"defineGroupNextFields");br.exports=ho});var Rr=T((dl,Ar)=>{var uo=xr(),Nr=Pr(),_o=Or(),To=d(e=>{let i=uo(e);return{...Nr(e),type:i,properties:kr(_o(e,i))}},"reverseGroupField"),po=d(e=>e.isNested,"isGroupType"),kr=d(e=>Object.values(e).reduce((i,r)=>po(r)?Object.assign(i,{[r.name]:To(r)}):Object.assign(i,{[r.name]:Nr(r)}),{}),"convertFieldSchemasToJSON");Ar.exports={convertFieldSchemasToJSON:kr}});var Mr=T((fl,Cr)=>{Cr.exports=e=>i=>({$schema:"http://json-schema.org/draft-04/schema#",type:"object",title:e,properties:i})});var Dr=T((cl,Ur)=>{var wo=We(),yo=d(e=>i=>e?{...i,creator:e}:i,"includeCreator"),mo=d(e=>i=>!e||!Array.isArray(e)?i:{...i,extra:e.map(({key:r,value:t})=>({extraKey:r,extraValue:t}))},"includeExtra"),go=d(e=>i=>wo([yo(e.created_by),mo(e.key_value_metadata)])(i),"includeMetadataInJSONSchema");Ur.exports=go});var Ni=T((ul,qr)=>{var zr={},vo=d(e=>{zr.lodash=e.require("lodash")},"setDependencies");qr.exports={setDependencies:vo,dependencies:zr}});var Yr=T((Tl,Gr)=>{var{dependencies:Io}=Ni(),Eo=d((e,i)=>({...e,...i}),"add"),Vr=d((e,i)=>{let r=Io.lodash,t=d((y,w)=>Object.keys(y).reduce((m,v)=>Eo(m,{[v]:w(y[v])}),{}),"mapProperties"),n=d((y,w)=>Array.isArray(y)?y.map(m=>w(m)):r.isPlainObject(y)?w(y):y,"mapItems"),s=d((y,w,m)=>y.reduce((v,S)=>v[S]?{...v,[S]:m(v[S])}:v,w),"applyTo");if(!r.isPlainObject(e))return e;let o=r.partial(Vr,r.partial.placeholder,i),l=["properties","definitions","patternProperties"],c=["items","oneOf","allOf","anyOf","not"],h={...e},u=s(l,h,r.partial(t,r.partial.placeholder,o)),_=s(c,u,r.partial(n,r.partial.placeholder,o));return i(_)},"mapJsonSchema");Gr.exports=Vr});var jr=T((wl,Wr)=>{var{setDependencies:So}=Ni(),Bo=Yr(),Fo=d(e=>e.mode==="int"?{...e,type:"int"}:e.mode==="decimal"?{...e,type:"double"}:e.mode==="double"?{...e,type:"double"}:e,"handleNumericType"),xo=d(e=>Bo(e,i=>i.type==="number"?Fo(i):i),"adaptSchema"),Lo=d((e,i,r,t)=>{So(t),i.log("info","Adaptation of JSON Schema started...","Adapt JSON Schema");try{let n=JSON.parse(e.jsonSchema),s=xo(n);i.log("info","Adaptation of JSON Schema finished.","Adapt JSON Schema"),r(null,{jsonSchema:JSON.stringify(s)})}catch(n){let s={message:`${n.message}
File name: ${e.fileName}`,stack:n.stack};i.log("error",s,"Adaptation of JSON Schema Error"),r(s)}},"adaptJsonSchema");Wr.exports={adaptJsonSchema:Lo}});var Po=Sr(),bo=Rr(),Oo=Mr(),No=Dr(),ko=We(),Hr=require("path"),{adaptJsonSchema:Ao}=jr();module.exports={async reFromFile(e,i,r){try{let{filePath:t}=e,n=Hr.basename(t,".parquet"),{schema:s,metadata:o,rowGroups:l}=await Po.readParquetFile(t),c=bo.convertFieldSchemasToJSON(s),h=ko([Oo(n),No(o)])(c);r(null,{containerName:"New namespace",jsonSchema:JSON.stringify({...h,rowGroups:l},null,4)})}catch(t){let n=Hr.basename(e.filePath),s={message:`${t.message}
File name: ${n}`,stack:t.stack};i.log("error",s,"Parquet Reverse-Engineering Error"),r(s)}},adaptJsonSchema:Ao};
